{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/teams/actions.ts"],"sourcesContent":["'use server';\n\nimport { createClient } from '@/lib/supabase/server';\nimport { requireDetailer } from '@/lib/auth';\nimport { getDetailerOrganization, getOrganizationRole } from '@/lib/detailer/mode-detection';\nimport { canManageTeams } from '@/lib/detailer/permissions';\n\n/**\n * Create a new team\n */\nexport async function createTeam(\n  organizationId: string,\n  name: string,\n  description: string | null,\n  serviceArea: any,\n  detailerIds: string[]\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const organization = await getDetailerOrganization();\n  if (!organization || organization.id !== organizationId) {\n    throw new Error('Organization not found');\n  }\n\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to create teams');\n  }\n\n  // Create team\n  const { data: team, error: teamError } = await supabase\n    .from('teams')\n    .insert({\n      organization_id: organizationId,\n      name,\n      description,\n      service_area: serviceArea,\n      is_active: true,\n    })\n    .select()\n    .single();\n\n  if (teamError || !team) {\n    throw new Error('Failed to create team');\n  }\n\n  // Add team members\n  if (detailerIds.length > 0) {\n    const { error: membersError } = await supabase\n      .from('team_members')\n      .insert(\n        detailerIds.map((detailerId) => ({\n          team_id: team.id,\n          detailer_id: detailerId,\n        }))\n      );\n\n    if (membersError) {\n      console.error('Failed to add team members:', membersError);\n      // Don't throw - team was created\n    }\n  }\n\n  return team;\n}\n\n/**\n * Update a team\n */\nexport async function updateTeam(\n  teamId: string,\n  name: string,\n  description: string | null,\n  serviceArea: any,\n  detailerIds: string[]\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Get team to verify organization\n  const { data: team } = await supabase\n    .from('teams')\n    .select('organization_id')\n    .eq('id', teamId)\n    .single();\n\n  if (!team) {\n    throw new Error('Team not found');\n  }\n\n  // Check permissions\n  const userRole = await getOrganizationRole(team.organization_id);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to update teams');\n  }\n\n  // Update team\n  const { error: updateError } = await supabase\n    .from('teams')\n    .update({\n      name,\n      description,\n      service_area: serviceArea,\n    })\n    .eq('id', teamId);\n\n  if (updateError) {\n    throw new Error('Failed to update team');\n  }\n\n  // Update team members\n  // Remove all existing members\n  await supabase.from('team_members').delete().eq('team_id', teamId);\n\n  // Add new members\n  if (detailerIds.length > 0) {\n    const { error: membersError } = await supabase\n      .from('team_members')\n      .insert(\n        detailerIds.map((detailerId) => ({\n          team_id: teamId,\n          detailer_id: detailerId,\n        }))\n      );\n\n    if (membersError) {\n      console.error('Failed to update team members:', membersError);\n    }\n  }\n\n  return { success: true };\n}\n\n/**\n * Delete a team (soft delete)\n */\nexport async function deleteTeam(teamId: string) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Get team to verify organization\n  const { data: team } = await supabase\n    .from('teams')\n    .select('organization_id')\n    .eq('id', teamId)\n    .single();\n\n  if (!team) {\n    throw new Error('Team not found');\n  }\n\n  // Check permissions\n  const userRole = await getOrganizationRole(team.organization_id);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to delete teams');\n  }\n\n  // Soft delete\n  const { error } = await supabase\n    .from('teams')\n    .update({ is_active: false })\n    .eq('id', teamId);\n\n  if (error) {\n    throw new Error('Failed to delete team');\n  }\n\n  return { success: true };\n}\n\n"],"names":[],"mappings":";;;;;;;IA0IsB,aAAA,WAAA,GAAA,IAAA,iRAAA,EAAA,8CAAA,sQAAA,EAAA,KAAA,GAAA,4QAAA,EAAA"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/teams/TeamsPageClient.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport TeamForm from '@/components/detailer/TeamForm';\nimport { deleteTeam } from './actions';\n\ninterface Team {\n  id: string;\n  name: string;\n  description: string | null;\n  service_area: any;\n  is_active: boolean;\n  created_at: string;\n  team_members?: Array<{\n    id: string;\n    detailer: {\n      id: string;\n      full_name: string;\n      profile?: {\n        email: string;\n      };\n    };\n  }>;\n}\n\ninterface TeamsPageClientProps {\n  initialTeams: Team[];\n  organizationId: string;\n}\n\nexport default function TeamsPageClient({ initialTeams, organizationId }: TeamsPageClientProps) {\n  const [teams, setTeams] = useState<Team[]>(initialTeams);\n  const [loading, setLoading] = useState(false);\n  const [formOpen, setFormOpen] = useState(false);\n  const [editingTeam, setEditingTeam] = useState<Team | null>(null);\n  const supabase = createClient();\n  const router = useRouter();\n\n  const handleCreate = () => {\n    setEditingTeam(null);\n    setFormOpen(true);\n  };\n\n  const handleEdit = (team: Team) => {\n    setEditingTeam(team);\n    setFormOpen(true);\n  };\n\n  const handleDelete = async (teamId: string) => {\n    if (!confirm('Are you sure you want to delete this team?')) return;\n    try {\n      await deleteTeam(teamId);\n      router.refresh();\n    } catch (error: any) {\n      alert(error.message || 'Failed to delete team');\n    }\n  };\n\n  const handleSaved = () => {\n    router.refresh();\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Teams List */}\n      <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-xl font-semibold text-white\">All Teams</h2>\n          <button\n            className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors\"\n            onClick={handleCreate}\n          >\n            + Create Team\n          </button>\n        </div>\n\n        {teams.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <p className=\"text-[#C6CFD9] mb-4\">No teams created yet</p>\n            <button\n              className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors\"\n              onClick={handleCreate}\n            >\n              Create Your First Team\n            </button>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {teams.map((team) => (\n              <div\n                key={team.id}\n                className=\"bg-[#050B12] border border-white/5 rounded-lg p-6 hover:border-[#32CE7A]/40 transition-colors\"\n              >\n                <div className=\"flex justify-between items-start mb-2\">\n                  <Link href={`/detailer/teams/${team.id}`} className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-white mb-2\">{team.name}</h3>\n                  </Link>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => handleEdit(team)}\n                      className=\"text-[#32CE7A] hover:text-[#6FF0C4] text-sm\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => handleDelete(team.id)}\n                      className=\"text-red-400 hover:text-red-300 text-sm\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n                {team.description && (\n                  <p className=\"text-sm text-[#C6CFD9] mb-4\">{team.description}</p>\n                )}\n                <div className=\"flex items-center justify-between text-sm\">\n                  <span className=\"text-[#C6CFD9]\">\n                    {team.team_members?.length || 0} member{team.team_members?.length !== 1 ? 's' : ''}\n                  </span>\n                  <Link\n                    href={`/detailer/teams/${team.id}`}\n                    className=\"text-[#32CE7A] hover:text-[#6FF0C4]\"\n                  >\n                    View Details â†’\n                  </Link>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Info Box */}\n      <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl p-6\">\n        <h3 className=\"text-lg font-semibold text-white mb-2\">About Teams</h3>\n        <p className=\"text-[#C6CFD9] text-sm\">\n          Teams allow you to organize detailers into groups. Each team can have its own service area\n          and be assigned to specific jobs. This helps with routing and scheduling.\n        </p>\n        <p className=\"text-[#C6CFD9] text-sm mt-2\">\n          <strong>Note:</strong> Full team management features (create, edit, assign members) will be\n          available in Phase 3.\n        </p>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AAiCe,SAAS,gBAAgB,EAAE,YAAY,EAAE,cAAc,EAAwB;IAC5F,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,mPAAQ,EAAS;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,mPAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,mPAAQ,EAAC;IACzC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,mPAAQ,EAAc;IAC5D,MAAM,WAAW,IAAA,2KAAY;IAC7B,MAAM,SAAS,IAAA,iLAAS;IAExB,MAAM,eAAe;QACnB,eAAe;QACf,YAAY;IACd;IAEA,MAAM,aAAa,CAAC;QAClB,eAAe;QACf,YAAY;IACd;IAEA,MAAM,eAAe,OAAO;QAC1B,IAAI,CAAC,QAAQ,+CAA+C;QAC5D,IAAI;YACF,MAAM,IAAA,gNAAU,EAAC;YACjB,OAAO,OAAO;QAChB,EAAE,OAAO,OAAY;YACnB,MAAM,MAAM,OAAO,IAAI;QACzB;IACF;IAEA,MAAM,cAAc;QAClB,OAAO,OAAO;IAChB;IAEA,qBACE,gRAAC;QAAI,WAAU;;0BAEb,gRAAC;gBAAI,WAAU;;kCACb,gRAAC;wBAAI,WAAU;;0CACb,gRAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,gRAAC;gCACC,WAAU;gCACV,SAAS;0CACV;;;;;;;;;;;;oBAKF,MAAM,MAAM,KAAK,kBAChB,gRAAC;wBAAI,WAAU;;0CACb,gRAAC;gCAAE,WAAU;0CAAsB;;;;;;0CACnC,gRAAC;gCACC,WAAU;gCACV,SAAS;0CACV;;;;;;;;;;;6CAKH,gRAAC;wBAAI,WAAU;kCACZ,MAAM,GAAG,CAAC,CAAC,qBACV,gRAAC;gCAEC,WAAU;;kDAEV,gRAAC;wCAAI,WAAU;;0DACb,gRAAC,yMAAI;gDAAC,MAAM,CAAC,gBAAgB,EAAE,KAAK,EAAE,EAAE;gDAAE,WAAU;0DAClD,cAAA,gRAAC;oDAAG,WAAU;8DAAyC,KAAK,IAAI;;;;;;;;;;;0DAElE,gRAAC;gDAAI,WAAU;;kEACb,gRAAC;wDACC,SAAS,IAAM,WAAW;wDAC1B,WAAU;kEACX;;;;;;kEAGD,gRAAC;wDACC,SAAS,IAAM,aAAa,KAAK,EAAE;wDACnC,WAAU;kEACX;;;;;;;;;;;;;;;;;;oCAKJ,KAAK,WAAW,kBACf,gRAAC;wCAAE,WAAU;kDAA+B,KAAK,WAAW;;;;;;kDAE9D,gRAAC;wCAAI,WAAU;;0DACb,gRAAC;gDAAK,WAAU;;oDACb,KAAK,YAAY,EAAE,UAAU;oDAAE;oDAAQ,KAAK,YAAY,EAAE,WAAW,IAAI,MAAM;;;;;;;0DAElF,gRAAC,yMAAI;gDACH,MAAM,CAAC,gBAAgB,EAAE,KAAK,EAAE,EAAE;gDAClC,WAAU;0DACX;;;;;;;;;;;;;+BAhCE,KAAK,EAAE;;;;;;;;;;;;;;;;0BA2CtB,gRAAC;gBAAI,WAAU;;kCACb,gRAAC;wBAAG,WAAU;kCAAwC;;;;;;kCACtD,gRAAC;wBAAE,WAAU;kCAAyB;;;;;;kCAItC,gRAAC;wBAAE,WAAU;;0CACX,gRAAC;0CAAO;;;;;;4BAAc;;;;;;;;;;;;;;;;;;;AAMhC"}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// eslint-disable-next-line import/no-extraneous-dependencies\nexport { createServerReference } from 'react-server-dom-webpack/client'\n"],"names":["callServer","createServerReference","findSourceMapURL"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IAMVC,qBAAqB,EAAA;eAArBA,QAAAA,qBAAqB;;IALrBC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;wBAKK","ignoreList":[0]}}]
}
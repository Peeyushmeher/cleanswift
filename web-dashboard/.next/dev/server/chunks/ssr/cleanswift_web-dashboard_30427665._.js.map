{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/lib/detailer/permissions.ts"],"sourcesContent":["/**\n * Permission utilities for role-based access control\n * Defines what each role can do in the organization\n */\n\nexport enum OrganizationRole {\n  Owner = 'owner',\n  Manager = 'manager',\n  Dispatcher = 'dispatcher',\n  Detailer = 'detailer',\n}\n\nexport type OrganizationRoleType = 'owner' | 'manager' | 'dispatcher' | 'detailer';\n\n/**\n * Check if a role can assign jobs\n */\nexport function canAssignJobs(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can manage teams\n */\nexport function canManageTeams(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can manage members\n */\nexport function canManageMembers(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can view organization earnings\n */\nexport function canViewOrgEarnings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can manage organization settings\n */\nexport function canManageOrgSettings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner;\n}\n\n/**\n * Check if a role can change member roles\n */\nexport function canChangeMemberRoles(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner;\n}\n\n/**\n * Check if a role can remove members\n */\nexport function canRemoveMembers(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can view all organization bookings\n */\nexport function canViewAllOrgBookings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can update booking status\n */\nexport function canUpdateBookingStatus(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can create payout batches\n */\nexport function canCreatePayoutBatches(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Get all permissions for a role\n */\nexport function getRolePermissions(role: OrganizationRoleType | null) {\n  return {\n    canAssignJobs: canAssignJobs(role),\n    canManageTeams: canManageTeams(role),\n    canManageMembers: canManageMembers(role),\n    canViewOrgEarnings: canViewOrgEarnings(role),\n    canManageOrgSettings: canManageOrgSettings(role),\n    canChangeMemberRoles: canChangeMemberRoles(role),\n    canRemoveMembers: canRemoveMembers(role),\n    canViewAllOrgBookings: canViewAllOrgBookings(role),\n    canUpdateBookingStatus: canUpdateBookingStatus(role),\n    canCreatePayoutBatches: canCreatePayoutBatches(role),\n  };\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;;;;;;;;;;;;;;;AAEM,IAAA,AAAK,0CAAA;;;;;WAAA;;AAYL,SAAS,cAAc,IAAiC;IAC7D,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,eAAe,IAAiC;IAC9D,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,iBAAiB,IAAiC;IAChE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,mBAAmB,IAAiC;IAClE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,qBAAqB,IAAiC;IACpE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO;AACT;AAKO,SAAS,qBAAqB,IAAiC;IACpE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO;AACT;AAKO,SAAS,iBAAiB,IAAiC;IAChE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,sBAAsB,IAAiC;IACrE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,uBAAuB,IAAiC;IACtE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,uBAAuB,IAAiC;IACtE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,mBAAmB,IAAiC;IAClE,OAAO;QACL,eAAe,cAAc;QAC7B,gBAAgB,eAAe;QAC/B,kBAAkB,iBAAiB;QACnC,oBAAoB,mBAAmB;QACvC,sBAAsB,qBAAqB;QAC3C,sBAAsB,qBAAqB;QAC3C,kBAAkB,iBAAiB;QACnC,uBAAuB,sBAAsB;QAC7C,wBAAwB,uBAAuB;QAC/C,wBAAwB,uBAAuB;IACjD;AACF"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/teams/actions.ts"],"sourcesContent":["'use server';\n\nimport { createClient } from '@/lib/supabase/server';\nimport { requireDetailer } from '@/lib/auth';\nimport { getDetailerOrganization, getOrganizationRole } from '@/lib/detailer/mode-detection';\nimport { canManageTeams } from '@/lib/detailer/permissions';\n\n/**\n * Create a new team\n */\nexport async function createTeam(\n  organizationId: string,\n  name: string,\n  description: string | null,\n  serviceArea: any,\n  detailerIds: string[]\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const organization = await getDetailerOrganization();\n  if (!organization || organization.id !== organizationId) {\n    throw new Error('Organization not found');\n  }\n\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to create teams');\n  }\n\n  // Create team\n  const { data: team, error: teamError } = await supabase\n    .from('teams')\n    .insert({\n      organization_id: organizationId,\n      name,\n      description,\n      service_area: serviceArea,\n      is_active: true,\n    })\n    .select()\n    .single();\n\n  if (teamError || !team) {\n    throw new Error('Failed to create team');\n  }\n\n  // Add team members\n  if (detailerIds.length > 0) {\n    const { error: membersError } = await supabase\n      .from('team_members')\n      .insert(\n        detailerIds.map((detailerId) => ({\n          team_id: team.id,\n          detailer_id: detailerId,\n        }))\n      );\n\n    if (membersError) {\n      console.error('Failed to add team members:', membersError);\n      // Don't throw - team was created\n    }\n  }\n\n  return team;\n}\n\n/**\n * Update a team\n */\nexport async function updateTeam(\n  teamId: string,\n  name: string,\n  description: string | null,\n  serviceArea: any,\n  detailerIds: string[]\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Get team to verify organization\n  const { data: team } = await supabase\n    .from('teams')\n    .select('organization_id')\n    .eq('id', teamId)\n    .single();\n\n  if (!team) {\n    throw new Error('Team not found');\n  }\n\n  // Check permissions\n  const userRole = await getOrganizationRole(team.organization_id);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to update teams');\n  }\n\n  // Update team\n  const { error: updateError } = await supabase\n    .from('teams')\n    .update({\n      name,\n      description,\n      service_area: serviceArea,\n    })\n    .eq('id', teamId);\n\n  if (updateError) {\n    throw new Error('Failed to update team');\n  }\n\n  // Update team members\n  // Remove all existing members\n  await supabase.from('team_members').delete().eq('team_id', teamId);\n\n  // Add new members\n  if (detailerIds.length > 0) {\n    const { error: membersError } = await supabase\n      .from('team_members')\n      .insert(\n        detailerIds.map((detailerId) => ({\n          team_id: teamId,\n          detailer_id: detailerId,\n        }))\n      );\n\n    if (membersError) {\n      console.error('Failed to update team members:', membersError);\n    }\n  }\n\n  return { success: true };\n}\n\n/**\n * Delete a team (soft delete)\n */\nexport async function deleteTeam(teamId: string) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Get team to verify organization\n  const { data: team } = await supabase\n    .from('teams')\n    .select('organization_id')\n    .eq('id', teamId)\n    .single();\n\n  if (!team) {\n    throw new Error('Team not found');\n  }\n\n  // Check permissions\n  const userRole = await getOrganizationRole(team.organization_id);\n  if (!canManageTeams(userRole)) {\n    throw new Error('You do not have permission to delete teams');\n  }\n\n  // Soft delete\n  const { error } = await supabase\n    .from('teams')\n    .update({ is_active: false })\n    .eq('id', teamId);\n\n  if (error) {\n    throw new Error('Failed to delete team');\n  }\n\n  return { success: true };\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/.next-internal/server/app/detailer/teams/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {deleteTeam as '40818020bd46baf457f11ead61a43c0a5eb6a72a6c'} from 'ACTIONS_MODULE0'\nexport {createTeam as '7c3b50b01530e1c9b0fbe935d1c44fa0b6c274044b'} from 'ACTIONS_MODULE0'\nexport {updateTeam as '7ca37a6007a6dbc124d74e0760defede774851b4c7'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}
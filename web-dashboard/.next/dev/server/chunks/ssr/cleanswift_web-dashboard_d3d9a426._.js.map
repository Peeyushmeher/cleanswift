{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/lib/detailer/permissions.ts"],"sourcesContent":["/**\n * Permission utilities for role-based access control\n * Defines what each role can do in the organization\n */\n\nexport enum OrganizationRole {\n  Owner = 'owner',\n  Manager = 'manager',\n  Dispatcher = 'dispatcher',\n  Detailer = 'detailer',\n}\n\nexport type OrganizationRoleType = 'owner' | 'manager' | 'dispatcher' | 'detailer';\n\n/**\n * Check if a role can assign jobs\n */\nexport function canAssignJobs(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can manage teams\n */\nexport function canManageTeams(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can manage members\n */\nexport function canManageMembers(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can view organization earnings\n */\nexport function canViewOrgEarnings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can manage organization settings\n */\nexport function canManageOrgSettings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner;\n}\n\n/**\n * Check if a role can change member roles\n */\nexport function canChangeMemberRoles(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner;\n}\n\n/**\n * Check if a role can remove members\n */\nexport function canRemoveMembers(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Check if a role can view all organization bookings\n */\nexport function canViewAllOrgBookings(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can update booking status\n */\nexport function canUpdateBookingStatus(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager || role === OrganizationRole.Dispatcher;\n}\n\n/**\n * Check if a role can create payout batches\n */\nexport function canCreatePayoutBatches(role: OrganizationRoleType | null): boolean {\n  if (!role) return false;\n  return role === OrganizationRole.Owner || role === OrganizationRole.Manager;\n}\n\n/**\n * Get all permissions for a role\n */\nexport function getRolePermissions(role: OrganizationRoleType | null) {\n  return {\n    canAssignJobs: canAssignJobs(role),\n    canManageTeams: canManageTeams(role),\n    canManageMembers: canManageMembers(role),\n    canViewOrgEarnings: canViewOrgEarnings(role),\n    canManageOrgSettings: canManageOrgSettings(role),\n    canChangeMemberRoles: canChangeMemberRoles(role),\n    canRemoveMembers: canRemoveMembers(role),\n    canViewAllOrgBookings: canViewAllOrgBookings(role),\n    canUpdateBookingStatus: canUpdateBookingStatus(role),\n    canCreatePayoutBatches: canCreatePayoutBatches(role),\n  };\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;;;;;;;;;;;;;;;AAEM,IAAA,AAAK,0CAAA;;;;;WAAA;;AAYL,SAAS,cAAc,IAAiC;IAC7D,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,eAAe,IAAiC;IAC9D,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,iBAAiB,IAAiC;IAChE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,mBAAmB,IAAiC;IAClE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,qBAAqB,IAAiC;IACpE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO;AACT;AAKO,SAAS,qBAAqB,IAAiC;IACpE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO;AACT;AAKO,SAAS,iBAAiB,IAAiC;IAChE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,sBAAsB,IAAiC;IACrE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,uBAAuB,IAAiC;IACtE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC,sBAAqC;AACjF;AAKO,SAAS,uBAAuB,IAAiC;IACtE,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,oBAAmC;AAC5C;AAKO,SAAS,mBAAmB,IAAiC;IAClE,OAAO;QACL,eAAe,cAAc;QAC7B,gBAAgB,eAAe;QAC/B,kBAAkB,iBAAiB;QACnC,oBAAoB,mBAAmB;QACvC,sBAAsB,qBAAqB;QAC3C,sBAAsB,qBAAqB;QAC3C,kBAAkB,iBAAiB;QACnC,uBAAuB,sBAAsB;QAC7C,wBAAwB,uBAAuB;QAC/C,wBAAwB,uBAAuB;IACjD;AACF"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/members/actions.ts"],"sourcesContent":["'use server';\n\nimport { createClient } from '@/lib/supabase/server';\nimport { requireDetailer } from '@/lib/auth';\nimport { getDetailerOrganization, getOrganizationRole } from '@/lib/detailer/mode-detection';\nimport { canManageMembers, canChangeMemberRoles, canRemoveMembers } from '@/lib/detailer/permissions';\n\n/**\n * Invite a member to the organization\n */\nexport async function inviteMember(\n  organizationId: string,\n  email: string,\n  role: 'detailer' | 'dispatcher' | 'manager' | 'owner'\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const organization = await getDetailerOrganization();\n  if (!organization || organization.id !== organizationId) {\n    throw new Error('Organization not found');\n  }\n\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canManageMembers(userRole)) {\n    throw new Error('You do not have permission to invite members');\n  }\n\n  // Only owners can invite owners\n  if (role === 'owner' && userRole !== 'owner') {\n    throw new Error('Only owners can invite other owners');\n  }\n\n  // Call RPC function\n  const { data, error } = await supabase.rpc('invite_member', {\n    p_organization_id: organizationId,\n    p_email: email,\n    p_role: role,\n  });\n\n  if (error) {\n    throw new Error(error.message || 'Failed to invite member');\n  }\n\n  return data;\n}\n\n/**\n * Update a member's role\n */\nexport async function updateMemberRole(\n  organizationId: string,\n  profileId: string,\n  newRole: 'detailer' | 'dispatcher' | 'manager' | 'owner'\n) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canChangeMemberRoles(userRole)) {\n    throw new Error('You do not have permission to change member roles');\n  }\n\n  // Call RPC function\n  const { error } = await supabase.rpc('update_member_role', {\n    p_organization_id: organizationId,\n    p_profile_id: profileId,\n    p_new_role: newRole,\n  });\n\n  if (error) {\n    throw new Error(error.message || 'Failed to update member role');\n  }\n\n  return { success: true };\n}\n\n/**\n * Suspend a member (set is_active = false)\n */\nexport async function suspendMember(organizationId: string, profileId: string) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canRemoveMembers(userRole)) {\n    throw new Error('You do not have permission to suspend members');\n  }\n\n  // Prevent suspending yourself\n  const { data: { user } } = await supabase.auth.getUser();\n  if (user?.id === profileId) {\n    throw new Error('You cannot suspend yourself');\n  }\n\n  // Update member\n  const { error } = await supabase\n    .from('organization_members')\n    .update({ is_active: false })\n    .eq('organization_id', organizationId)\n    .eq('profile_id', profileId);\n\n  if (error) {\n    throw new Error('Failed to suspend member');\n  }\n\n  return { success: true };\n}\n\n/**\n * Activate a member (set is_active = true)\n */\nexport async function activateMember(organizationId: string, profileId: string) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canRemoveMembers(userRole)) {\n    throw new Error('You do not have permission to activate members');\n  }\n\n  // Update member\n  const { error } = await supabase\n    .from('organization_members')\n    .update({ is_active: true })\n    .eq('organization_id', organizationId)\n    .eq('profile_id', profileId);\n\n  if (error) {\n    throw new Error('Failed to activate member');\n  }\n\n  return { success: true };\n}\n\n/**\n * Remove a member from the organization\n */\nexport async function removeMember(organizationId: string, profileId: string) {\n  const supabase = await createClient();\n  await requireDetailer();\n\n  // Check permissions\n  const userRole = await getOrganizationRole(organizationId);\n  if (!canRemoveMembers(userRole)) {\n    throw new Error('You do not have permission to remove members');\n  }\n\n  // Prevent removing yourself\n  const { data: { user } } = await supabase.auth.getUser();\n  if (user?.id === profileId) {\n    throw new Error('You cannot remove yourself');\n  }\n\n  // Call RPC function\n  const { error } = await supabase.rpc('remove_member', {\n    p_organization_id: organizationId,\n    p_profile_id: profileId,\n  });\n\n  if (error) {\n    throw new Error(error.message || 'Failed to remove member');\n  }\n\n  return { success: true };\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 254, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/.next-internal/server/app/detailer/members/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {updateMemberRole as '703797e60fbb016fcd7e046529634bfa1142bd67fc'} from 'ACTIONS_MODULE0'\nexport {suspendMember as '60a446d426f2f65cea46c4dbb7faf5d0e0fb8e9767'} from 'ACTIONS_MODULE0'\nexport {activateMember as '60ac567f52cdf60cae3ffb68e1cc50e927cf81aab6'} from 'ACTIONS_MODULE0'\nexport {removeMember as '6028be15458b9994fe185ed90031cf0d041b61eb22'} from 'ACTIONS_MODULE0'\nexport {inviteMember as '70cf6a3cfbe6ca7139d4ac7a295622ae64a88301d6'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/ContactCustomer.tsx"],"sourcesContent":["'use client';\n\nexport default function ContactCustomer({ phone }: { phone?: string }) {\n  const handleCopyPhone = () => {\n    if (phone) {\n      navigator.clipboard.writeText(phone);\n      alert('Phone number copied to clipboard');\n    }\n  };\n\n  if (!phone) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex gap-4\">\n      <a\n        href={`tel:${phone}`}\n        className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors\"\n      >\n        Call {phone}\n      </a>\n      <button\n        onClick={handleCopyPhone}\n        className=\"px-4 py-2 bg-[#0A1A2F] border border-white/5 hover:border-[#32CE7A]/40 text-white font-semibold rounded-lg transition-colors\"\n      >\n        Copy Phone\n      </button>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAAA;;AAEe,SAAS,gBAAgB,EAAE,KAAK,EAAsB;IACnE,MAAM,kBAAkB;QACtB,IAAI,OAAO;YACT,UAAU,SAAS,CAAC,SAAS,CAAC;YAC9B,MAAM;QACR;IACF;IAEA,IAAI,CAAC,OAAO;QACV,OAAO;IACT;IAEA,qBACE,+NAAC;QAAI,WAAU;;0BACb,+NAAC;gBACC,MAAM,CAAC,IAAI,EAAE,OAAO;gBACpB,WAAU;;oBACX;oBACO;;;;;;;0BAER,+NAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAKP;KA5BwB"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/JobMap.tsx"],"sourcesContent":["'use client';\n\ninterface JobMapProps {\n  address: string;\n  latitude?: number;\n  longitude?: number;\n  city?: string;\n  province?: string;\n}\n\nexport default function JobMap({ address, latitude, longitude, city, province }: JobMapProps) {\n  // Generate Google Maps embed URL\n  const getMapUrl = () => {\n    if (latitude && longitude) {\n      return `https://www.google.com/maps?q=${latitude},${longitude}&z=15&output=embed`;\n    }\n    // Fallback to address search\n    const query = encodeURIComponent(`${address}, ${city}, ${province}`);\n    return `https://www.google.com/maps?q=${query}&z=15&output=embed`;\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-lg font-semibold text-white\">Location</h3>\n      <div className=\"text-[#C6CFD9] mb-4\">\n        <div>{address}</div>\n        {city && province && (\n          <div>\n            {city}, {province}\n          </div>\n        )}\n      </div>\n      <div className=\"w-full h-64 rounded-lg overflow-hidden border border-white/5\">\n        <iframe\n          width=\"100%\"\n          height=\"100%\"\n          frameBorder=\"0\"\n          style={{ border: 0 }}\n          src={getMapUrl()}\n          allowFullScreen\n          loading=\"lazy\"\n          referrerPolicy=\"no-referrer-when-downgrade\"\n        />\n      </div>\n      <a\n        href={`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${address}, ${city}, ${province}`)}`}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className=\"inline-flex items-center gap-2 text-[#32CE7A] hover:text-[#6FF0C4] text-sm font-medium\"\n      >\n        Open in Google Maps ‚Üí\n      </a>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAAA;;AAUe,SAAS,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAe;IAC1F,iCAAiC;IACjC,MAAM,YAAY;QAChB,IAAI,YAAY,WAAW;YACzB,OAAO,CAAC,8BAA8B,EAAE,SAAS,CAAC,EAAE,UAAU,kBAAkB,CAAC;QACnF;QACA,6BAA6B;QAC7B,MAAM,QAAQ,mBAAmB,GAAG,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,UAAU;QACnE,OAAO,CAAC,8BAA8B,EAAE,MAAM,kBAAkB,CAAC;IACnE;IAEA,qBACE,+NAAC;QAAI,WAAU;;0BACb,+NAAC;gBAAG,WAAU;0BAAmC;;;;;;0BACjD,+NAAC;gBAAI,WAAU;;kCACb,+NAAC;kCAAK;;;;;;oBACL,QAAQ,0BACP,+NAAC;;4BACE;4BAAK;4BAAG;;;;;;;;;;;;;0BAIf,+NAAC;gBAAI,WAAU;0BACb,cAAA,+NAAC;oBACC,OAAM;oBACN,QAAO;oBACP,aAAY;oBACZ,OAAO;wBAAE,QAAQ;oBAAE;oBACnB,KAAK;oBACL,eAAe;oBACf,SAAQ;oBACR,gBAAe;;;;;;;;;;;0BAGnB,+NAAC;gBACC,MAAM,CAAC,mDAAmD,EAAE,mBAAmB,GAAG,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,UAAU,GAAG;gBACpH,QAAO;gBACP,KAAI;gBACJ,WAAU;0BACX;;;;;;;;;;;;AAKP;KA5CwB"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/lib/detailer/dashboard-utils.ts"],"sourcesContent":["// Utility functions for Detailer Dashboard\n\n/**\n * Format a number as currency\n */\nexport function formatCurrency(amount: number | string): string {\n  const num = typeof amount === 'string' ? parseFloat(amount) : amount;\n  if (isNaN(num)) return '$0.00';\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(num);\n}\n\n/**\n * Format a date string to a readable format\n */\nexport function formatDate(date: string | Date, format: 'short' | 'long' | 'time' = 'short'): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  \n  if (format === 'time') {\n    return d.toLocaleTimeString('en-US', { \n      hour: 'numeric', \n      minute: '2-digit',\n      hour12: true \n    });\n  }\n  \n  if (format === 'long') {\n    return d.toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n    });\n  }\n  \n  return d.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric',\n  });\n}\n\n/**\n * Format a date and time together\n */\nexport function formatDateTime(date: string, time: string): string {\n  const dateObj = new Date(`${date}T${time}`);\n  return formatDate(dateObj, 'long');\n}\n\n/**\n * Calculate total earnings from bookings\n */\nexport function calculateEarnings(bookings: Array<{ total_amount?: number; service_price?: number }>): number {\n  return bookings.reduce((sum, booking) => {\n    const amount = booking.total_amount || booking.service_price || 0;\n    return sum + (typeof amount === 'string' ? parseFloat(amount) : amount);\n  }, 0);\n}\n\n/**\n * Calculate distance between two coordinates (Haversine formula)\n * Returns distance in kilometers\n */\nexport function calculateDistance(\n  lat1: number,\n  lon1: number,\n  lat2: number,\n  lon2: number\n): number {\n  const R = 6371; // Radius of the Earth in kilometers\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lon2 - lon1);\n  \n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRad(lat1)) *\n      Math.cos(toRad(lat2)) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  \n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c;\n  \n  return Math.round(distance * 10) / 10; // Round to 1 decimal place\n}\n\n/**\n * Convert degrees to radians\n */\nfunction toRad(degrees: number): number {\n  return degrees * (Math.PI / 180);\n}\n\n/**\n * Format distance with unit\n */\nexport function formatDistance(km: number): string {\n  if (km < 1) {\n    return `${Math.round(km * 1000)}m`;\n  }\n  return `${km}km`;\n}\n\n/**\n * Get status color class\n */\nexport function getStatusColor(status: string): string {\n  switch (status) {\n    case 'accepted':\n      return 'bg-[#1DA4F3]/20 border-[#1DA4F3]/40 text-[#1DA4F3]';\n    case 'in_progress':\n      return 'bg-[#6FF0C4]/20 border-[#6FF0C4]/40 text-[#6FF0C4]';\n    case 'completed':\n      return 'bg-[#32CE7A]/20 border-[#32CE7A]/40 text-[#32CE7A]';\n    case 'cancelled':\n    case 'no_show':\n      return 'bg-red-500/20 border-red-500/40 text-red-400';\n    case 'paid':\n    case 'offered':\n      return 'bg-yellow-500/20 border-yellow-500/40 text-yellow-400';\n    default:\n      return 'bg-[#C6CFD9]/20 border-[#C6CFD9]/40 text-[#C6CFD9]';\n  }\n}\n\n/**\n * Get payment status color class\n */\nexport function getPaymentStatusColor(status: string): string {\n  switch (status) {\n    case 'paid':\n      return 'text-[#32CE7A]';\n    case 'processing':\n      return 'text-yellow-400';\n    case 'failed':\n    case 'refunded':\n      return 'text-red-400';\n    default:\n      return 'text-[#C6CFD9]';\n  }\n}\n\n/**\n * Filter bookings by date range\n */\nexport function filterBookingsByDateRange(\n  bookings: Array<{ scheduled_date?: string; scheduled_start?: string }>,\n  range: 'today' | 'tomorrow' | 'this_week' | 'this_month' | 'all'\n): Array<any> {\n  if (range === 'all') return bookings;\n  \n  const now = new Date();\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  \n  return bookings.filter((booking) => {\n    const bookingDate = booking.scheduled_date \n      ? new Date(booking.scheduled_date)\n      : booking.scheduled_start \n      ? new Date(booking.scheduled_start)\n      : null;\n    \n    if (!bookingDate) return false;\n    \n    const bookingDateOnly = new Date(\n      bookingDate.getFullYear(),\n      bookingDate.getMonth(),\n      bookingDate.getDate()\n    );\n    \n    switch (range) {\n      case 'today':\n        return bookingDateOnly.getTime() === today.getTime();\n      \n      case 'tomorrow':\n        const tomorrow = new Date(today);\n        tomorrow.setDate(tomorrow.getDate() + 1);\n        return bookingDateOnly.getTime() === tomorrow.getTime();\n      \n      case 'this_week':\n        const weekStart = new Date(today);\n        weekStart.setDate(today.getDate() - today.getDay());\n        const weekEnd = new Date(weekStart);\n        weekEnd.setDate(weekStart.getDate() + 6);\n        return bookingDate >= weekStart && bookingDate <= weekEnd;\n      \n      case 'this_month':\n        return (\n          bookingDate.getMonth() === today.getMonth() &&\n          bookingDate.getFullYear() === today.getFullYear()\n        );\n      \n      default:\n        return true;\n    }\n  });\n}\n\n/**\n * Sort bookings\n */\nexport function sortBookings(\n  bookings: Array<any>,\n  sortBy: 'time' | 'distance' | 'price' | 'rating' | 'assignment'\n): Array<any> {\n  const sorted = [...bookings];\n  \n  switch (sortBy) {\n    case 'time':\n      return sorted.sort((a, b) => {\n        const dateA = a.scheduled_date || a.scheduled_start || '';\n        const dateB = b.scheduled_date || b.scheduled_start || '';\n        return new Date(dateA).getTime() - new Date(dateB).getTime();\n      });\n    \n    case 'price':\n      return sorted.sort((a, b) => {\n        const priceA = a.total_amount || a.service_price || 0;\n        const priceB = b.total_amount || b.service_price || 0;\n        return priceB - priceA;\n      });\n    \n    case 'distance':\n      // This would require current location\n      return sorted;\n    \n    case 'rating':\n      // This would require customer rating\n      return sorted;\n    \n    case 'assignment':\n      return sorted.sort((a, b) => {\n        const dateA = new Date(a.created_at || 0).getTime();\n        const dateB = new Date(b.created_at || 0).getTime();\n        return dateB - dateA;\n      });\n    \n    default:\n      return sorted;\n  }\n}\n\n"],"names":[],"mappings":"AAAA,2CAA2C;AAE3C;;CAEC;;;;;;;;;;;;;;;;;;;;;;AACM,SAAS,eAAe,MAAuB;IACpD,MAAM,MAAM,OAAO,WAAW,WAAW,WAAW,UAAU;IAC9D,IAAI,MAAM,MAAM,OAAO;IACvB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAKO,SAAS,WAAW,IAAmB,EAAE,SAAoC,OAAO;IACzF,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IAEtD,IAAI,WAAW,QAAQ;QACrB,OAAO,EAAE,kBAAkB,CAAC,SAAS;YACnC,MAAM;YACN,QAAQ;YACR,QAAQ;QACV;IACF;IAEA,IAAI,WAAW,QAAQ;QACrB,OAAO,EAAE,kBAAkB,CAAC,SAAS;YACnC,SAAS;YACT,MAAM;YACN,OAAO;YACP,KAAK;YACL,MAAM;YACN,QAAQ;YACR,QAAQ;QACV;IACF;IAEA,OAAO,EAAE,kBAAkB,CAAC,SAAS;QACnC,OAAO;QACP,KAAK;QACL,MAAM;IACR;AACF;AAKO,SAAS,eAAe,IAAY,EAAE,IAAY;IACvD,MAAM,UAAU,IAAI,KAAK,GAAG,KAAK,CAAC,EAAE,MAAM;IAC1C,OAAO,WAAW,SAAS;AAC7B;AAKO,SAAS,kBAAkB,QAAkE;IAClG,OAAO,SAAS,MAAM,CAAC,CAAC,KAAK;QAC3B,MAAM,SAAS,QAAQ,YAAY,IAAI,QAAQ,aAAa,IAAI;QAChE,OAAO,MAAM,CAAC,OAAO,WAAW,WAAW,WAAW,UAAU,MAAM;IACxE,GAAG;AACL;AAMO,SAAS,kBACd,IAAY,EACZ,IAAY,EACZ,IAAY,EACZ,IAAY;IAEZ,MAAM,IAAI,MAAM,oCAAoC;IACpD,MAAM,OAAO,MAAM,OAAO;IAC1B,MAAM,OAAO,MAAM,OAAO;IAE1B,MAAM,IACJ,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO,KACrC,KAAK,GAAG,CAAC,MAAM,SACb,KAAK,GAAG,CAAC,MAAM,SACf,KAAK,GAAG,CAAC,OAAO,KAChB,KAAK,GAAG,CAAC,OAAO;IAEpB,MAAM,IAAI,IAAI,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;IACrD,MAAM,WAAW,IAAI;IAErB,OAAO,KAAK,KAAK,CAAC,WAAW,MAAM,IAAI,2BAA2B;AACpE;AAEA;;CAEC,GACD,SAAS,MAAM,OAAe;IAC5B,OAAO,UAAU,CAAC,KAAK,EAAE,GAAG,GAAG;AACjC;AAKO,SAAS,eAAe,EAAU;IACvC,IAAI,KAAK,GAAG;QACV,OAAO,GAAG,KAAK,KAAK,CAAC,KAAK,MAAM,CAAC,CAAC;IACpC;IACA,OAAO,GAAG,GAAG,EAAE,CAAC;AAClB;AAKO,SAAS,eAAe,MAAc;IAC3C,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;QACL,KAAK;YACH,OAAO;QACT,KAAK;QACL,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAKO,SAAS,sBAAsB,MAAc;IAClD,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;QACL,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAKO,SAAS,0BACd,QAAsE,EACtE,KAAgE;IAEhE,IAAI,UAAU,OAAO,OAAO;IAE5B,MAAM,MAAM,IAAI;IAChB,MAAM,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO;IAErE,OAAO,SAAS,MAAM,CAAC,CAAC;QACtB,MAAM,cAAc,QAAQ,cAAc,GACtC,IAAI,KAAK,QAAQ,cAAc,IAC/B,QAAQ,eAAe,GACvB,IAAI,KAAK,QAAQ,eAAe,IAChC;QAEJ,IAAI,CAAC,aAAa,OAAO;QAEzB,MAAM,kBAAkB,IAAI,KAC1B,YAAY,WAAW,IACvB,YAAY,QAAQ,IACpB,YAAY,OAAO;QAGrB,OAAQ;YACN,KAAK;gBACH,OAAO,gBAAgB,OAAO,OAAO,MAAM,OAAO;YAEpD,KAAK;gBACH,MAAM,WAAW,IAAI,KAAK;gBAC1B,SAAS,OAAO,CAAC,SAAS,OAAO,KAAK;gBACtC,OAAO,gBAAgB,OAAO,OAAO,SAAS,OAAO;YAEvD,KAAK;gBACH,MAAM,YAAY,IAAI,KAAK;gBAC3B,UAAU,OAAO,CAAC,MAAM,OAAO,KAAK,MAAM,MAAM;gBAChD,MAAM,UAAU,IAAI,KAAK;gBACzB,QAAQ,OAAO,CAAC,UAAU,OAAO,KAAK;gBACtC,OAAO,eAAe,aAAa,eAAe;YAEpD,KAAK;gBACH,OACE,YAAY,QAAQ,OAAO,MAAM,QAAQ,MACzC,YAAY,WAAW,OAAO,MAAM,WAAW;YAGnD;gBACE,OAAO;QACX;IACF;AACF;AAKO,SAAS,aACd,QAAoB,EACpB,MAA+D;IAE/D,MAAM,SAAS;WAAI;KAAS;IAE5B,OAAQ;QACN,KAAK;YACH,OAAO,OAAO,IAAI,CAAC,CAAC,GAAG;gBACrB,MAAM,QAAQ,EAAE,cAAc,IAAI,EAAE,eAAe,IAAI;gBACvD,MAAM,QAAQ,EAAE,cAAc,IAAI,EAAE,eAAe,IAAI;gBACvD,OAAO,IAAI,KAAK,OAAO,OAAO,KAAK,IAAI,KAAK,OAAO,OAAO;YAC5D;QAEF,KAAK;YACH,OAAO,OAAO,IAAI,CAAC,CAAC,GAAG;gBACrB,MAAM,SAAS,EAAE,YAAY,IAAI,EAAE,aAAa,IAAI;gBACpD,MAAM,SAAS,EAAE,YAAY,IAAI,EAAE,aAAa,IAAI;gBACpD,OAAO,SAAS;YAClB;QAEF,KAAK;YACH,sCAAsC;YACtC,OAAO;QAET,KAAK;YACH,qCAAqC;YACrC,OAAO;QAET,KAAK;YACH,OAAO,OAAO,IAAI,CAAC,CAAC,GAAG;gBACrB,MAAM,QAAQ,IAAI,KAAK,EAAE,UAAU,IAAI,GAAG,OAAO;gBACjD,MAAM,QAAQ,IAAI,KAAK,EAAE,UAAU,IAAI,GAAG,OAAO;gBACjD,OAAO,QAAQ;YACjB;QAEF;YACE,OAAO;IACX;AACF"}},
    {"offset": {"line": 358, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/JobNotes.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { formatDate } from '@/lib/detailer/dashboard-utils';\nimport { createClient } from '@/lib/supabase/client';\nimport type { BookingNote } from '@/types/detailer';\n\ninterface JobNotesProps {\n  bookingId: string;\n  initialNotes: BookingNote[];\n}\n\nexport default function JobNotes({ bookingId, initialNotes }: JobNotesProps) {\n  const [notes, setNotes] = useState<BookingNote[]>(initialNotes);\n  const [newNote, setNewNote] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const supabase = createClient();\n\n  const handleAddNote = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newNote.trim()) return;\n\n    setIsSubmitting(true);\n    try {\n      const { data, error } = await supabase\n        .from('booking_notes')\n        .insert({\n          booking_id: bookingId,\n          note_text: newNote.trim(),\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setNotes([...notes, data]);\n      setNewNote('');\n    } catch (error) {\n      console.error('Error adding note:', error);\n      alert('Failed to add note');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-lg font-semibold text-white\">Internal Notes</h3>\n\n      {/* Add note form */}\n      <form onSubmit={handleAddNote} className=\"space-y-2\">\n        <textarea\n          value={newNote}\n          onChange={(e) => setNewNote(e.target.value)}\n          placeholder=\"Add a note...\"\n          className=\"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40 resize-none\"\n          rows={3}\n        />\n        <button\n          type=\"submit\"\n          disabled={isSubmitting || !newNote.trim()}\n          className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          {isSubmitting ? 'Adding...' : 'Add Note'}\n        </button>\n      </form>\n\n      {/* Notes list */}\n      <div className=\"space-y-3\">\n        {notes.length === 0 ? (\n          <p className=\"text-[#C6CFD9] text-sm\">No notes yet</p>\n        ) : (\n          notes\n            .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())\n            .map((note) => (\n              <div\n                key={note.id}\n                className=\"bg-[#050B12] border border-white/5 rounded-lg p-4\"\n              >\n                <div className=\"flex justify-between items-start mb-2\">\n                  <div className=\"text-sm text-[#C6CFD9]\">\n                    {formatDate(note.created_at, 'long')}\n                  </div>\n                </div>\n                <div className=\"text-white whitespace-pre-wrap\">{note.note_text}</div>\n              </div>\n            ))\n        )}\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAYe,SAAS,SAAS,EAAE,SAAS,EAAE,YAAY,EAAiB;;IACzE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,2MAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2MAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,2MAAQ,EAAC;IACjD,MAAM,WAAW,IAAA,8KAAY;IAE7B,MAAM,gBAAgB,OAAO;QAC3B,EAAE,cAAc;QAChB,IAAI,CAAC,QAAQ,IAAI,IAAI;QAErB,gBAAgB;QAChB,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC;gBACN,YAAY;gBACZ,WAAW,QAAQ,IAAI;YACzB,GACC,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,SAAS;mBAAI;gBAAO;aAAK;YACzB,WAAW;QACb,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM;QACR,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,qBACE,+NAAC;QAAI,WAAU;;0BACb,+NAAC;gBAAG,WAAU;0BAAmC;;;;;;0BAGjD,+NAAC;gBAAK,UAAU;gBAAe,WAAU;;kCACvC,+NAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wBAC1C,aAAY;wBACZ,WAAU;wBACV,MAAM;;;;;;kCAER,+NAAC;wBACC,MAAK;wBACL,UAAU,gBAAgB,CAAC,QAAQ,IAAI;wBACvC,WAAU;kCAET,eAAe,cAAc;;;;;;;;;;;;0BAKlC,+NAAC;gBAAI,WAAU;0BACZ,MAAM,MAAM,KAAK,kBAChB,+NAAC;oBAAE,WAAU;8BAAyB;;;;;2BAEtC,MACG,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,IAChF,GAAG,CAAC,CAAC,qBACJ,+NAAC;wBAEC,WAAU;;0CAEV,+NAAC;gCAAI,WAAU;0CACb,cAAA,+NAAC;oCAAI,WAAU;8CACZ,IAAA,wLAAU,EAAC,KAAK,UAAU,EAAE;;;;;;;;;;;0CAGjC,+NAAC;gCAAI,WAAU;0CAAkC,KAAK,SAAS;;;;;;;uBAR1D,KAAK,EAAE;;;;;;;;;;;;;;;;AAe5B;GA/EwB;KAAA"}},
    {"offset": {"line": 506, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/JobTimeline.tsx"],"sourcesContent":["'use client';\n\nimport { formatDate } from '@/lib/detailer/dashboard-utils';\nimport type { BookingTimeline } from '@/types/detailer';\n\ninterface JobTimelineProps {\n  timeline: BookingTimeline[];\n  currentStatus: string;\n  createdAt: string;\n}\n\nexport default function JobTimeline({ timeline, currentStatus, createdAt }: JobTimelineProps) {\n  // Sort timeline by date (oldest first)\n  const sortedTimeline = [...timeline].sort(\n    (a, b) => new Date(a.changed_at).getTime() - new Date(b.changed_at).getTime()\n  );\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-lg font-semibold text-white mb-4\">Job Timeline</h3>\n      <div className=\"relative\">\n        {/* Timeline line */}\n        <div className=\"absolute left-4 top-0 bottom-0 w-0.5 bg-white/10\" />\n\n        <div className=\"space-y-6\">\n          {/* Initial state */}\n          <div className=\"relative flex items-start gap-4\">\n            <div className=\"relative z-10 w-8 h-8 rounded-full bg-[#32CE7A] border-4 border-[#0A1A2F] flex items-center justify-center\">\n              <div className=\"w-2 h-2 rounded-full bg-white\" />\n            </div>\n            <div className=\"flex-1 pt-1\">\n              <div className=\"text-white font-medium\">Booking Created</div>\n              <div className=\"text-sm text-[#C6CFD9]\">{formatDate(createdAt, 'long')}</div>\n            </div>\n          </div>\n\n          {/* Status transitions */}\n          {sortedTimeline.map((entry, index) => (\n            <div key={entry.id} className=\"relative flex items-start gap-4\">\n              <div className=\"relative z-10 w-8 h-8 rounded-full bg-[#6FF0C4] border-4 border-[#0A1A2F] flex items-center justify-center\">\n                <div className=\"w-2 h-2 rounded-full bg-white\" />\n              </div>\n              <div className=\"flex-1 pt-1\">\n                <div className=\"text-white font-medium\">\n                  {entry.status_from\n                    ? `${entry.status_from.replace('_', ' ')} ‚Üí ${entry.status_to.replace('_', ' ')}`\n                    : `Status: ${entry.status_to.replace('_', ' ')}`}\n                </div>\n                <div className=\"text-sm text-[#C6CFD9]\">{formatDate(entry.changed_at, 'long')}</div>\n                {entry.notes && (\n                  <div className=\"text-sm text-[#C6CFD9] mt-1 italic\">{entry.notes}</div>\n                )}\n              </div>\n            </div>\n          ))}\n\n          {/* Current status */}\n          {sortedTimeline.length > 0 && (\n            <div className=\"relative flex items-start gap-4\">\n              <div className=\"relative z-10 w-8 h-8 rounded-full bg-[#32CE7A] border-4 border-[#0A1A2F] flex items-center justify-center\">\n                <div className=\"w-2 h-2 rounded-full bg-white\" />\n              </div>\n              <div className=\"flex-1 pt-1\">\n                <div className=\"text-white font-medium\">Current Status: {currentStatus.replace('_', ' ')}</div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAWe,SAAS,YAAY,EAAE,QAAQ,EAAE,aAAa,EAAE,SAAS,EAAoB;IAC1F,uCAAuC;IACvC,MAAM,iBAAiB;WAAI;KAAS,CAAC,IAAI,CACvC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO;IAG7E,qBACE,+NAAC;QAAI,WAAU;;0BACb,+NAAC;gBAAG,WAAU;0BAAwC;;;;;;0BACtD,+NAAC;gBAAI,WAAU;;kCAEb,+NAAC;wBAAI,WAAU;;;;;;kCAEf,+NAAC;wBAAI,WAAU;;0CAEb,+NAAC;gCAAI,WAAU;;kDACb,+NAAC;wCAAI,WAAU;kDACb,cAAA,+NAAC;4CAAI,WAAU;;;;;;;;;;;kDAEjB,+NAAC;wCAAI,WAAU;;0DACb,+NAAC;gDAAI,WAAU;0DAAyB;;;;;;0DACxC,+NAAC;gDAAI,WAAU;0DAA0B,IAAA,wLAAU,EAAC,WAAW;;;;;;;;;;;;;;;;;;4BAKlE,eAAe,GAAG,CAAC,CAAC,OAAO,sBAC1B,+NAAC;oCAAmB,WAAU;;sDAC5B,+NAAC;4CAAI,WAAU;sDACb,cAAA,+NAAC;gDAAI,WAAU;;;;;;;;;;;sDAEjB,+NAAC;4CAAI,WAAU;;8DACb,+NAAC;oDAAI,WAAU;8DACZ,MAAM,WAAW,GACd,GAAG,MAAM,WAAW,CAAC,OAAO,CAAC,KAAK,KAAK,GAAG,EAAE,MAAM,SAAS,CAAC,OAAO,CAAC,KAAK,MAAM,GAC/E,CAAC,QAAQ,EAAE,MAAM,SAAS,CAAC,OAAO,CAAC,KAAK,MAAM;;;;;;8DAEpD,+NAAC;oDAAI,WAAU;8DAA0B,IAAA,wLAAU,EAAC,MAAM,UAAU,EAAE;;;;;;gDACrE,MAAM,KAAK,kBACV,+NAAC;oDAAI,WAAU;8DAAsC,MAAM,KAAK;;;;;;;;;;;;;mCAZ5D,MAAM,EAAE;;;;;4BAmBnB,eAAe,MAAM,GAAG,mBACvB,+NAAC;gCAAI,WAAU;;kDACb,+NAAC;wCAAI,WAAU;kDACb,cAAA,+NAAC;4CAAI,WAAU;;;;;;;;;;;kDAEjB,+NAAC;wCAAI,WAAU;kDACb,cAAA,+NAAC;4CAAI,WAAU;;gDAAyB;gDAAiB,cAAc,OAAO,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQpG;KA5DwB"}},
    {"offset": {"line": 718, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/PaymentBreakdown.tsx"],"sourcesContent":["import { formatCurrency } from '@/lib/detailer/dashboard-utils';\n\ninterface PaymentBreakdownProps {\n  servicePrice: number;\n  addonsTotal: number;\n  taxAmount: number;\n  totalAmount: number;\n  tipAmount?: number;\n  platformFee?: number;\n}\n\nexport default function PaymentBreakdown({\n  servicePrice,\n  addonsTotal,\n  taxAmount,\n  totalAmount,\n  tipAmount = 0,\n  platformFee,\n}: PaymentBreakdownProps) {\n  // Calculate platform fee if not provided (assume 10% for now)\n  const calculatedPlatformFee = platformFee || totalAmount * 0.1;\n  const payoutAmount = totalAmount - calculatedPlatformFee;\n\n  return (\n    <div className=\"space-y-2\">\n      <h3 className=\"text-lg font-semibold text-white mb-4\">Payment Breakdown</h3>\n      <div className=\"space-y-2 text-sm\">\n        <div className=\"flex justify-between text-[#C6CFD9]\">\n          <span>Service Price:</span>\n          <span className=\"text-white\">{formatCurrency(servicePrice)}</span>\n        </div>\n        {addonsTotal > 0 && (\n          <div className=\"flex justify-between text-[#C6CFD9]\">\n            <span>Add-ons:</span>\n            <span className=\"text-white\">{formatCurrency(addonsTotal)}</span>\n          </div>\n        )}\n        {tipAmount > 0 && (\n          <div className=\"flex justify-between text-[#C6CFD9]\">\n            <span>Tip:</span>\n            <span className=\"text-white\">{formatCurrency(tipAmount)}</span>\n          </div>\n        )}\n        <div className=\"flex justify-between text-[#C6CFD9]\">\n          <span>Tax:</span>\n          <span className=\"text-white\">{formatCurrency(taxAmount)}</span>\n        </div>\n        <div className=\"border-t border-white/10 pt-2 mt-2\">\n          <div className=\"flex justify-between text-white font-semibold\">\n            <span>Total:</span>\n            <span>{formatCurrency(totalAmount)}</span>\n          </div>\n        </div>\n        {calculatedPlatformFee > 0 && (\n          <>\n            <div className=\"flex justify-between text-[#C6CFD9]\">\n              <span>Platform Fee (10%):</span>\n              <span className=\"text-white\">{formatCurrency(calculatedPlatformFee)}</span>\n            </div>\n            <div className=\"border-t border-white/10 pt-2 mt-2\">\n              <div className=\"flex justify-between text-[#32CE7A] font-semibold\">\n                <span>Your Payout:</span>\n                <span>{formatCurrency(payoutAmount)}</span>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAAA;;;AAWe,SAAS,iBAAiB,EACvC,YAAY,EACZ,WAAW,EACX,SAAS,EACT,WAAW,EACX,YAAY,CAAC,EACb,WAAW,EACW;IACtB,8DAA8D;IAC9D,MAAM,wBAAwB,eAAe,cAAc;IAC3D,MAAM,eAAe,cAAc;IAEnC,qBACE,+NAAC;QAAI,WAAU;;0BACb,+NAAC;gBAAG,WAAU;0BAAwC;;;;;;0BACtD,+NAAC;gBAAI,WAAU;;kCACb,+NAAC;wBAAI,WAAU;;0CACb,+NAAC;0CAAK;;;;;;0CACN,+NAAC;gCAAK,WAAU;0CAAc,IAAA,4LAAc,EAAC;;;;;;;;;;;;oBAE9C,cAAc,mBACb,+NAAC;wBAAI,WAAU;;0CACb,+NAAC;0CAAK;;;;;;0CACN,+NAAC;gCAAK,WAAU;0CAAc,IAAA,4LAAc,EAAC;;;;;;;;;;;;oBAGhD,YAAY,mBACX,+NAAC;wBAAI,WAAU;;0CACb,+NAAC;0CAAK;;;;;;0CACN,+NAAC;gCAAK,WAAU;0CAAc,IAAA,4LAAc,EAAC;;;;;;;;;;;;kCAGjD,+NAAC;wBAAI,WAAU;;0CACb,+NAAC;0CAAK;;;;;;0CACN,+NAAC;gCAAK,WAAU;0CAAc,IAAA,4LAAc,EAAC;;;;;;;;;;;;kCAE/C,+NAAC;wBAAI,WAAU;kCACb,cAAA,+NAAC;4BAAI,WAAU;;8CACb,+NAAC;8CAAK;;;;;;8CACN,+NAAC;8CAAM,IAAA,4LAAc,EAAC;;;;;;;;;;;;;;;;;oBAGzB,wBAAwB,mBACvB;;0CACE,+NAAC;gCAAI,WAAU;;kDACb,+NAAC;kDAAK;;;;;;kDACN,+NAAC;wCAAK,WAAU;kDAAc,IAAA,4LAAc,EAAC;;;;;;;;;;;;0CAE/C,+NAAC;gCAAI,WAAU;0CACb,cAAA,+NAAC;oCAAI,WAAU;;sDACb,+NAAC;sDAAK;;;;;;sDACN,+NAAC;sDAAM,IAAA,4LAAc,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQtC;KA3DwB"}},
    {"offset": {"line": 951, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/PhotoUpload.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { formatDate } from '@/lib/detailer/dashboard-utils';\nimport type { JobPhoto } from '@/types/detailer';\n\ninterface PhotoUploadProps {\n  bookingId: string;\n  initialPhotos: JobPhoto[];\n}\n\nexport default function PhotoUpload({ bookingId, initialPhotos }: PhotoUploadProps) {\n  const [photos, setPhotos] = useState<JobPhoto[]>(initialPhotos);\n  const [uploading, setUploading] = useState(false);\n  const [photoType, setPhotoType] = useState<'before' | 'after'>('before');\n  const supabase = createClient();\n\n  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setUploading(true);\n    try {\n      // Upload to Supabase Storage\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${bookingId}/${photoType}_${Date.now()}.${fileExt}`;\n      const filePath = `job-photos/${fileName}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from('job-photos')\n        .upload(filePath, file);\n\n      if (uploadError) throw uploadError;\n\n      // Get public URL\n      const { data: { publicUrl } } = supabase.storage\n        .from('job-photos')\n        .getPublicUrl(filePath);\n\n      // Create database record\n      const { data, error } = await supabase\n        .from('job_photos')\n        .insert({\n          booking_id: bookingId,\n          photo_url: publicUrl,\n          photo_type: photoType,\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setPhotos([...photos, data]);\n    } catch (error) {\n      console.error('Error uploading photo:', error);\n      alert('Failed to upload photo');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleDeletePhoto = async (photoId: string, photoUrl: string) => {\n    if (!confirm('Delete this photo?')) return;\n\n    try {\n      // Extract file path from URL\n      const urlParts = photoUrl.split('/job-photos/');\n      const filePath = urlParts[1];\n\n      // Delete from storage\n      await supabase.storage.from('job-photos').remove([filePath]);\n\n      // Delete from database\n      const { error } = await supabase\n        .from('job_photos')\n        .delete()\n        .eq('id', photoId);\n\n      if (error) throw error;\n\n      setPhotos(photos.filter(p => p.id !== photoId));\n    } catch (error) {\n      console.error('Error deleting photo:', error);\n      alert('Failed to delete photo');\n    }\n  };\n\n  const beforePhotos = photos.filter(p => p.photo_type === 'before');\n  const afterPhotos = photos.filter(p => p.photo_type === 'after');\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-lg font-semibold text-white\">Job Photos</h3>\n\n      {/* Upload controls */}\n      <div className=\"flex gap-4 items-center\">\n        <select\n          value={photoType}\n          onChange={(e) => setPhotoType(e.target.value as 'before' | 'after')}\n          className=\"px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white focus:outline-none focus:border-[#32CE7A]/40\"\n        >\n          <option value=\"before\">Before</option>\n          <option value=\"after\">After</option>\n        </select>\n        <label className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg cursor-pointer transition-colors\">\n          {uploading ? 'Uploading...' : 'Upload Photo'}\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handleFileUpload}\n            disabled={uploading}\n            className=\"hidden\"\n          />\n        </label>\n      </div>\n\n      {/* Before photos */}\n      {beforePhotos.length > 0 && (\n        <div>\n          <h4 className=\"text-md font-semibold text-white mb-2\">Before Photos</h4>\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n            {beforePhotos.map((photo) => (\n              <div key={photo.id} className=\"relative group\">\n                <img\n                  src={photo.photo_url}\n                  alt=\"Before\"\n                  className=\"w-full h-48 object-cover rounded-lg border border-white/5\"\n                />\n                <button\n                  onClick={() => handleDeletePhoto(photo.id, photo.photo_url)}\n                  className=\"absolute top-2 right-2 p-2 bg-red-500/80 hover:bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity\"\n                >\n                  √ó\n                </button>\n                <div className=\"text-xs text-[#C6CFD9] mt-1\">\n                  {formatDate(photo.uploaded_at, 'short')}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* After photos */}\n      {afterPhotos.length > 0 && (\n        <div>\n          <h4 className=\"text-md font-semibold text-white mb-2\">After Photos</h4>\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n            {afterPhotos.map((photo) => (\n              <div key={photo.id} className=\"relative group\">\n                <img\n                  src={photo.photo_url}\n                  alt=\"After\"\n                  className=\"w-full h-48 object-cover rounded-lg border border-white/5\"\n                />\n                <button\n                  onClick={() => handleDeletePhoto(photo.id, photo.photo_url)}\n                  className=\"absolute top-2 right-2 p-2 bg-red-500/80 hover:bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity\"\n                >\n                  √ó\n                </button>\n                <div className=\"text-xs text-[#C6CFD9] mt-1\">\n                  {formatDate(photo.uploaded_at, 'short')}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {photos.length === 0 && (\n        <p className=\"text-[#C6CFD9] text-sm\">No photos uploaded yet</p>\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1233, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/ui/StatusBadge.tsx"],"sourcesContent":["import { getStatusColor } from '@/lib/detailer/dashboard-utils';\n\ninterface StatusBadgeProps {\n  status: string;\n  className?: string;\n}\n\nexport default function StatusBadge({ status, className = '' }: StatusBadgeProps) {\n  const colorClass = getStatusColor(status);\n  \n  return (\n    <span\n      className={`px-2 py-1 text-xs font-medium rounded-full border ${colorClass} ${className}`}\n    >\n      {status.replace('_', ' ')}\n    </span>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAAA;;;AAOe,SAAS,YAAY,EAAE,MAAM,EAAE,YAAY,EAAE,EAAoB;IAC9E,MAAM,aAAa,IAAA,4LAAc,EAAC;IAElC,qBACE,+NAAC;QACC,WAAW,CAAC,kDAAkD,EAAE,WAAW,CAAC,EAAE,WAAW;kBAExF,OAAO,OAAO,CAAC,KAAK;;;;;;AAG3B;KAVwB"}},
    {"offset": {"line": 1262, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/ui/LoadingSpinner.tsx"],"sourcesContent":["interface LoadingSpinnerProps {\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nexport default function LoadingSpinner({ size = 'md', className = '' }: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: 'w-4 h-4',\n    md: 'w-8 h-8',\n    lg: 'w-12 h-12',\n  };\n\n  return (\n    <div className={`flex items-center justify-center ${className}`}>\n      <div\n        className={`${sizeClasses[size]} border-4 border-[#0A1A2F] border-t-[#32CE7A] rounded-full animate-spin`}\n        role=\"status\"\n        aria-label=\"Loading\"\n      >\n        <span className=\"sr-only\">Loading...</span>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;;AAKe,SAAS,eAAe,EAAE,OAAO,IAAI,EAAE,YAAY,EAAE,EAAuB;IACzF,MAAM,cAAc;QAClB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,+NAAC;QAAI,WAAW,CAAC,iCAAiC,EAAE,WAAW;kBAC7D,cAAA,+NAAC;YACC,WAAW,GAAG,WAAW,CAAC,KAAK,CAAC,uEAAuE,CAAC;YACxG,MAAK;YACL,cAAW;sBAEX,cAAA,+NAAC;gBAAK,WAAU;0BAAU;;;;;;;;;;;;;;;;AAIlC;KAlBwB"}},
    {"offset": {"line": 1309, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/bookings/actions.ts"],"sourcesContent":["'use server';\n\nimport { requireDetailer, getDetailerMode } from '@/lib/auth';\nimport { getDetailerOrganization, getOrganizationRole } from '@/lib/detailer/mode-detection';\nimport { canAssignJobs } from '@/lib/detailer/permissions';\nimport { assignBookingToDetailer } from '@/lib/services/bookings';\n\n/**\n * Assign a job to a detailer\n */\nexport async function assignJobToDetailer(bookingId: string, detailerId: string) {\n  await requireDetailer();\n\n  const mode = await getDetailerMode();\n  if (mode === 'organization') {\n    const organization = await getDetailerOrganization();\n    if (organization) {\n      const role = await getOrganizationRole(organization.id);\n      if (!canAssignJobs(role)) {\n        throw new Error('You do not have permission to assign jobs');\n      }\n    }\n  }\n\n  await assignBookingToDetailer(bookingId, detailerId);\n\n  return { success: true };\n}\n\n"],"names":[],"mappings":";;;;;;;IAUsB,sBAAA,WAAA,GAAA,IAAA,oRAAA,EAAA,8CAAA,yQAAA,EAAA,KAAA,GAAA,+QAAA,EAAA"}},
    {"offset": {"line": 1324, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/components/detailer/JobAssignmentModal.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport LoadingSpinner from '@/components/ui/LoadingSpinner';\nimport { assignJobToDetailer } from '@/app/detailer/bookings/actions';\n\ninterface Detailer {\n  id: string;\n  full_name: string;\n  rating: number;\n  review_count: number;\n  current_job_count?: number;\n  distance?: number;\n  is_available?: boolean;\n}\n\ninterface JobAssignmentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  bookingId: string;\n  organizationId: string;\n  currentDetailerId?: string | null;\n  onAssigned: () => void;\n}\n\nexport default function JobAssignmentModal({\n  isOpen,\n  onClose,\n  bookingId,\n  organizationId,\n  currentDetailerId,\n  onAssigned,\n}: JobAssignmentModalProps) {\n  const [detailers, setDetailers] = useState<Detailer[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [assigning, setAssigning] = useState(false);\n  const [selectedDetailerId, setSelectedDetailerId] = useState<string>('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterTeam, setFilterTeam] = useState<string>('all');\n  const [teams, setTeams] = useState<Array<{ id: string; name: string }>>([]);\n  const supabase = createClient();\n\n  useEffect(() => {\n    if (isOpen) {\n      loadDetailers();\n      loadTeams();\n    }\n  }, [isOpen, organizationId]);\n\n  const loadTeams = async () => {\n    const { data } = await supabase\n      .from('teams')\n      .select('id, name')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true);\n    setTeams(data || []);\n  };\n\n  const loadDetailers = async () => {\n    setLoading(true);\n    try {\n      // Get organization detailers\n      const { data: members } = await supabase.rpc('get_organization_members', {\n        p_organization_id: organizationId,\n      });\n\n      const detailerMembers = (members || []).filter((m: any) => m.role === 'detailer' && m.is_active);\n\n      // Get detailer records with ratings\n      const detailerIds = detailerMembers.map((m: any) => m.profile_id);\n      if (detailerIds.length === 0) {\n        setDetailers([]);\n        setLoading(false);\n        return;\n      }\n\n      const { data: detailerRecords } = await supabase\n        .from('detailers')\n        .select('id, full_name, rating, review_count')\n        .in('profile_id', detailerIds);\n\n      // Get current job counts\n      const { data: bookings } = await supabase\n        .from('bookings')\n        .select('detailer_id')\n        .eq('organization_id', organizationId)\n        .in('status', ['accepted', 'in_progress', 'scheduled']);\n\n      const jobCounts: Record<string, number> = {};\n      bookings?.forEach((b) => {\n        if (b.detailer_id) {\n          jobCounts[b.detailer_id] = (jobCounts[b.detailer_id] || 0) + 1;\n        }\n      });\n\n      // Combine data\n      const detailersWithCounts = (detailerRecords || []).map((d) => ({\n        id: d.id,\n        full_name: d.full_name,\n        rating: d.rating || 0,\n        review_count: d.review_count || 0,\n        current_job_count: jobCounts[d.id] || 0,\n        is_available: true, // TODO: Check availability slots\n      }));\n\n      setDetailers(detailersWithCounts);\n    } catch (error) {\n      console.error('Error loading detailers:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAssign = async () => {\n    if (!selectedDetailerId) return;\n\n    setAssigning(true);\n    try {\n      await assignJobToDetailer(bookingId, selectedDetailerId);\n      onAssigned();\n      onClose();\n    } catch (error) {\n      console.error('Error assigning job:', error);\n      alert('Failed to assign job. Please try again.');\n    } finally {\n      setAssigning(false);\n    }\n  };\n\n  const filteredDetailers = detailers.filter((d) => {\n    const matchesSearch = d.full_name.toLowerCase().includes(searchTerm.toLowerCase());\n    // TODO: Filter by team when team_id is available in detailer data\n    return matchesSearch;\n  });\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n      {/* Backdrop */}\n      <div\n        className=\"fixed inset-0 bg-black/50 backdrop-blur-sm\"\n        onClick={onClose}\n      />\n\n      {/* Modal */}\n      <div className=\"relative z-10 w-full max-w-2xl mx-4 bg-[#0A1A2F] border border-white/5 rounded-xl shadow-xl max-h-[90vh] overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-white/5\">\n          <div className=\"flex justify-between items-center\">\n            <h2 className=\"text-2xl font-bold text-white\">Assign Job to Detailer</h2>\n            <button\n              onClick={onClose}\n              className=\"text-[#C6CFD9] hover:text-white transition-colors\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {/* Search and Filters */}\n          <div className=\"mb-6 space-y-4\">\n            <input\n              type=\"text\"\n              placeholder=\"Search detailers...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40\"\n            />\n            {teams.length > 0 && (\n              <select\n                value={filterTeam}\n                onChange={(e) => setFilterTeam(e.target.value)}\n                className=\"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white focus:outline-none focus:border-[#32CE7A]/40\"\n              >\n                <option value=\"all\">All Teams</option>\n                {teams.map((team) => (\n                  <option key={team.id} value={team.id}>\n                    {team.name}\n                  </option>\n                ))}\n              </select>\n            )}\n          </div>\n\n          {/* Detailers List */}\n          {loading ? (\n            <div className=\"flex justify-center py-12\">\n              <LoadingSpinner size=\"lg\" />\n            </div>\n          ) : filteredDetailers.length === 0 ? (\n            <div className=\"text-center py-12 text-[#C6CFD9]\">\n              No detailers found\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {filteredDetailers.map((detailer) => (\n                <button\n                  key={detailer.id}\n                  onClick={() => setSelectedDetailerId(detailer.id)}\n                  className={`\n                    w-full p-4 rounded-lg border transition-colors text-left\n                    ${\n                      selectedDetailerId === detailer.id\n                        ? 'bg-[#32CE7A]/20 border-[#32CE7A]/40'\n                        : 'bg-[#050B12] border-white/5 hover:border-white/10'\n                    }\n                    ${detailer.id === currentDetailerId ? 'opacity-50 cursor-not-allowed' : ''}\n                  `}\n                  disabled={detailer.id === currentDetailerId}\n                >\n                  <div className=\"flex justify-between items-start\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3\">\n                        <h3 className=\"font-semibold text-white\">{detailer.full_name}</h3>\n                        {detailer.id === currentDetailerId && (\n                          <span className=\"text-xs bg-[#32CE7A]/20 text-[#32CE7A] px-2 py-1 rounded\">\n                            Current\n                          </span>\n                        )}\n                      </div>\n                      <div className=\"mt-2 flex items-center gap-4 text-sm text-[#C6CFD9]\">\n                        <span>‚≠ê {detailer.rating.toFixed(1)} ({detailer.review_count} reviews)</span>\n                        <span>üìã {detailer.current_job_count} active jobs</span>\n                        {detailer.distance && <span>üìç {detailer.distance.toFixed(1)} km</span>}\n                      </div>\n                    </div>\n                    {selectedDetailerId === detailer.id && (\n                      <div className=\"ml-4\">\n                        <div className=\"w-5 h-5 rounded-full bg-[#32CE7A] flex items-center justify-center\">\n                          <svg className=\"w-3 h-3 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                          </svg>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-6 border-t border-white/5 flex justify-end gap-3\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white hover:border-white/10 transition-colors\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleAssign}\n            disabled={!selectedDetailerId || assigning}\n            className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {assigning ? 'Assigning...' : 'Assign Job'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1762, "column": 0}, "map": {"version":3,"sources":["file:///Users/camps/cleanswift/web-dashboard/app/detailer/bookings/%5Bid%5D/BookingDetailClient.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport ContactCustomer from '@/components/detailer/ContactCustomer';\nimport JobMap from '@/components/detailer/JobMap';\nimport JobNotes from '@/components/detailer/JobNotes';\nimport JobTimeline from '@/components/detailer/JobTimeline';\nimport PaymentBreakdown from '@/components/detailer/PaymentBreakdown';\nimport PhotoUpload from '@/components/detailer/PhotoUpload';\nimport StatusBadge from '@/components/ui/StatusBadge';\nimport JobAssignmentModal from '@/components/detailer/JobAssignmentModal';\nimport { createClient } from '@/lib/supabase/client';\n\ninterface BookingDetailClientProps {\n  booking: any;\n  timeline: any[];\n  notes: any[];\n  photos: any[];\n  canUpdateStatus: boolean;\n  canReassign: boolean;\n  organizationId?: string;\n}\n\nexport default function BookingDetailClient({\n  booking,\n  timeline,\n  notes,\n  photos,\n  canUpdateStatus,\n  canReassign,\n  organizationId,\n}: BookingDetailClientProps) {\n  const [assignmentModalOpen, setAssignmentModalOpen] = useState(false);\n  const router = useRouter();\n  const supabase = createClient();\n\n  const handleAssigned = () => {\n    router.refresh();\n  };\n\n  const handleStatusUpdate = async (newStatus: string) => {\n    const { error } = await supabase.rpc('update_booking_status', {\n      p_booking_id: booking.id,\n      p_new_status: newStatus,\n    });\n\n    if (error) {\n      console.error('Error updating status:', error);\n      alert('Failed to update status');\n    } else {\n      router.refresh();\n    }\n  };\n\n  return (\n    <>\n      <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl p-6 mb-6\">\n        <div className=\"flex justify-between items-start mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-white mb-2\">\n              {booking.car?.make} {booking.car?.model} {booking.car?.year}\n            </h1>\n            <p className=\"text-[#C6CFD9]\">Booking #{booking.receipt_id}</p>\n            {canReassign && booking.detailer && (\n              <p className=\"text-sm text-[#C6CFD9] mt-1\">\n                Assigned to: <span className=\"text-[#32CE7A]\">{booking.detailer.full_name}</span>\n              </p>\n            )}\n          </div>\n          <div className=\"text-right\">\n            <div className=\"text-3xl font-bold text-[#32CE7A] mb-2\">\n              ${booking.service?.price || booking.total_amount || 0}\n            </div>\n            <StatusBadge status={booking.status} />\n          </div>\n        </div>\n\n        {canReassign && (\n          <div className=\"mb-6\">\n            <button\n              onClick={() => setAssignmentModalOpen(true)}\n              className=\"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors\"\n            >\n              {booking.detailer_id ? 'Reassign Job' : 'Assign Job'}\n            </button>\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Service Details</h2>\n            <div className=\"space-y-2 text-[#C6CFD9]\">\n              <div>\n                <strong>Service:</strong> {booking.service?.name}\n              </div>\n              <div>\n                <strong>Description:</strong> {booking.service?.description || 'N/A'}\n              </div>\n              <div>\n                <strong>Scheduled:</strong>{' '}\n                {new Date(booking.scheduled_start).toLocaleString()}\n              </div>\n              {booking.scheduled_end && (\n                <div>\n                  <strong>End Time:</strong> {new Date(booking.scheduled_end).toLocaleString()}\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div>\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Customer Information</h2>\n            <div className=\"space-y-2 text-[#C6CFD9]\">\n              <div>\n                <strong>Name:</strong> {booking.user?.full_name || booking.user_id || 'N/A'}\n              </div>\n              <div>\n                <strong>Phone:</strong> {booking.user?.phone || 'N/A'}\n              </div>\n              <div>\n                <strong>Email:</strong> {booking.user?.email || 'N/A'}\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Vehicle Information</h2>\n            <div className=\"space-y-2 text-[#C6CFD9]\">\n              <div>\n                <strong>Make/Model:</strong> {booking.car?.make && booking.car?.model \n                  ? `${booking.car.make} ${booking.car.model}` \n                  : 'N/A'}\n              </div>\n              <div>\n                <strong>Year:</strong> {booking.car?.year || 'N/A'}\n              </div>\n              <div>\n                <strong>License Plate:</strong> {booking.car?.license_plate || 'N/A'}\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Location</h2>\n            <JobMap\n              address={booking.address_line1 || ''}\n              latitude={booking.latitude}\n              longitude={booking.longitude}\n              city={booking.city}\n              province={booking.province}\n            />\n          </div>\n        </div>\n\n        {/* Payment Breakdown */}\n        <div className=\"mt-6 pt-6 border-t border-white/10\">\n          <PaymentBreakdown\n            servicePrice={booking.service_price || booking.service?.price || 0}\n            addonsTotal={booking.addons_total || 0}\n            taxAmount={booking.tax_amount || 0}\n            totalAmount={booking.total_amount || 0}\n          />\n        </div>\n\n        {/* Job Timeline */}\n        <div className=\"mt-6 pt-6 border-t border-white/10\">\n          <JobTimeline\n            timeline={timeline}\n            currentStatus={booking.status}\n            createdAt={booking.created_at}\n          />\n        </div>\n\n        {/* Photos */}\n        <div className=\"mt-6 pt-6 border-t border-white/10\">\n          <PhotoUpload bookingId={booking.id} initialPhotos={photos} />\n        </div>\n\n        {/* Notes */}\n        <div className=\"mt-6 pt-6 border-t border-white/10\">\n          <JobNotes bookingId={booking.id} initialNotes={notes} />\n        </div>\n\n        {/* Contact Customer */}\n        <div className=\"mt-6 pt-6 border-t border-white/10\">\n          <h2 className=\"text-lg font-semibold text-white mb-4\">Contact Customer</h2>\n          <ContactCustomer phone={booking.user?.phone} />\n        </div>\n\n        {/* Accept Offer Button */}\n        {booking.status === 'offered' && (\n          <div className=\"mt-6 pt-6 border-t border-white/10\">\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Accept Offer</h2>\n            <p className=\"text-[#C6CFD9] mb-4\">\n              This job has been offered to you. Accept it to add it to your schedule.\n            </p>\n            <button\n              onClick={async () => {\n                try {\n                  // For \"offered\" bookings that are already assigned, we need to use accept_booking\n                  // But accept_booking requires detailer_id to be NULL, so we need a different approach\n                  // Let's use a direct update that bypasses the RPC check for this specific case\n                  \n                  // First, get the current user's detailer record ID\n                  const { data: { user } } = await supabase.auth.getUser();\n                  if (!user) {\n                    alert('Not authenticated');\n                    return;\n                  }\n\n                  const { data: detailerRecord } = await supabase\n                    .from('detailers')\n                    .select('id')\n                    .eq('profile_id', user.id)\n                    .single();\n\n                  if (!detailerRecord) {\n                    alert('Detailer record not found');\n                    return;\n                  }\n\n                  // Check if booking is assigned to this detailer\n                  if (booking.detailer_id !== detailerRecord.id) {\n                    alert('This booking is not assigned to you');\n                    return;\n                  }\n\n                  // Update status directly (since we've verified access)\n                  const { error } = await supabase\n                    .from('bookings')\n                    .update({ \n                      status: 'accepted',\n                      updated_at: new Date().toISOString()\n                    })\n                    .eq('id', booking.id)\n                    .eq('detailer_id', detailerRecord.id);\n\n                  if (error) {\n                    console.error('Error accepting booking:', error);\n                    alert(`Failed to accept booking: ${error.message}`);\n                  } else {\n                    alert('Booking accepted! It will now appear in your schedule.');\n                    router.refresh();\n                  }\n                } catch (err) {\n                  console.error('Error accepting booking:', err);\n                  alert('Failed to accept booking. Please try again.');\n                }\n              }}\n              className=\"bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold py-3 px-8 rounded-lg transition-colors text-lg\"\n            >\n              Accept Offer\n            </button>\n          </div>\n        )}\n\n        {canUpdateStatus && (\n          <div className=\"mt-6 pt-6 border-t border-white/10\">\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Update Status</h2>\n            {booking.status === 'accepted' && (\n              <button\n                onClick={() => handleStatusUpdate('in_progress')}\n                className=\"bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold py-2 px-6 rounded-lg transition-colors\"\n              >\n                Start Service\n              </button>\n            )}\n            {booking.status === 'in_progress' && (\n              <button\n                onClick={() => handleStatusUpdate('completed')}\n                className=\"bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold py-2 px-6 rounded-lg transition-colors\"\n              >\n                Mark as Completed\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {canReassign && organizationId && (\n        <JobAssignmentModal\n          isOpen={assignmentModalOpen}\n          onClose={() => setAssignmentModalOpen(false)}\n          bookingId={booking.id}\n          organizationId={organizationId}\n          currentDetailerId={booking.detailer_id}\n          onAssigned={handleAssigned}\n        />\n      )}\n    </>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}
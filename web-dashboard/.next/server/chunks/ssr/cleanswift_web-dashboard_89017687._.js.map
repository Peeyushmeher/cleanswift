{"version":3,"sources":["../../../../../../cleanswift/web-dashboard/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../../../cleanswift/web-dashboard/app/admin/users/page.tsx","../../../../../../cleanswift/web-dashboard/.next-internal/server/app/admin/users/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","import { requireAdmin } from '@/lib/auth';\nimport { createClient } from '@/lib/supabase/server';\nimport { redirect } from 'next/navigation';\n\nexport default async function AdminUsersPage({\n  searchParams,\n}: {\n  searchParams: { role?: string };\n}) {\n  const profile = await requireAdmin();\n  const supabase = await createClient();\n\n  const roleFilter = searchParams.role || null;\n\n  // Get all users\n  const { data: users } = await supabase.rpc('get_all_users', {\n    p_role_filter: roleFilter as any,\n    p_limit: 100,\n    p_offset: 0,\n  });\n\n  async function updateRole(formData: FormData) {\n    'use server';\n    const userId = formData.get('user_id') as string;\n    const newRole = formData.get('role') as string;\n    if (userId && newRole) {\n      const supabase = await createClient();\n      await supabase.rpc('update_user_role', {\n        p_user_id: userId,\n        p_new_role: newRole as 'user' | 'detailer' | 'admin',\n      });\n      redirect('/admin/users');\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-[#050B12] text-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-white mb-2\">Users Management</h1>\n          <p className=\"text-[#C6CFD9]\">Manage user accounts and roles</p>\n        </div>\n\n        {/* Filters */}\n        <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl p-4 mb-6\">\n          <div className=\"flex gap-2 flex-wrap\">\n            <a\n              href=\"/admin/users\"\n              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n                !roleFilter\n                  ? 'bg-[#32CE7A] text-white'\n                  : 'bg-[#050B12] text-[#C6CFD9] hover:bg-white/5'\n              }`}\n            >\n              All\n            </a>\n            {['user', 'detailer', 'admin'].map((role) => (\n              <a\n                key={role}\n                href={`/admin/users?role=${role}`}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors capitalize ${\n                  roleFilter === role\n                    ? 'bg-[#32CE7A] text-white'\n                    : 'bg-[#050B12] text-[#C6CFD9] hover:bg-white/5'\n                }`}\n              >\n                {role}\n              </a>\n            ))}\n          </div>\n        </div>\n\n        {/* Users Table */}\n        {!users || users.length === 0 ? (\n          <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl p-8 text-center\">\n            <p className=\"text-[#C6CFD9]\">No users found</p>\n          </div>\n        ) : (\n          <div className=\"bg-[#0A1A2F] border border-white/5 rounded-xl overflow-hidden\">\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-[#050B12] border-b border-white/10\">\n                  <tr>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Name</th>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Email</th>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Phone</th>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Role</th>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Bookings</th>\n                    <th className=\"text-left py-3 px-4 text-[#C6CFD9] text-sm font-medium\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {users.map((user: any) => (\n                    <tr key={user.id} className=\"border-b border-white/5 hover:bg-white/5\">\n                      <td className=\"py-3 px-4 text-white text-sm\">{user.full_name}</td>\n                      <td className=\"py-3 px-4 text-white text-sm\">{user.email}</td>\n                      <td className=\"py-3 px-4 text-white text-sm\">{user.phone}</td>\n                      <td className=\"py-3 px-4 text-sm\">\n                        <span className=\"capitalize text-[#C6CFD9]\">{user.role}</span>\n                      </td>\n                      <td className=\"py-3 px-4 text-white text-sm\">{user.booking_count || 0}</td>\n                      <td className=\"py-3 px-4\">\n                        <form action={updateRole} className=\"flex gap-2\">\n                          <input type=\"hidden\" name=\"user_id\" value={user.id} />\n                          <select\n                            name=\"role\"\n                            defaultValue={user.role}\n                            className=\"px-3 py-1 bg-[#050B12] border border-white/10 rounded text-white text-sm focus:outline-none focus:ring-2 focus:ring-[#6FF0C4]\"\n                          >\n                            <option value=\"user\">User</option>\n                            <option value=\"detailer\">Detailer</option>\n                            <option value=\"admin\">Admin</option>\n                          </select>\n                          <button\n                            type=\"submit\"\n                            className=\"bg-[#32CE7A] hover:bg-[#2AB869] text-white text-sm font-semibold py-1 px-3 rounded transition-colors\"\n                          >\n                            Update\n                          </button>\n                        </form>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n","export {$$RSC_SERVER_ACTION_0 as '40f7840d6b2af554d4d8d5f57a66b605f21e8eb023'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference"],"mappings":"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","ignoreList":[0]}
module.exports=[59838,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(44322)},74857,a=>{"use strict";function b(a){return!!a&&("owner"===a||"manager"===a||"dispatcher"===a)}function c(a){return!!a&&("owner"===a||"manager"===a)}function d(a){return!!a&&("owner"===a||"manager"===a)}function e(a){return!!a&&("owner"===a||"manager"===a)}function f(a){return!!a&&"owner"===a}function g(a){return!!a&&"owner"===a}function h(a){return!!a&&("owner"===a||"manager"===a)}function i(a){return!!a&&("owner"===a||"manager"===a||"dispatcher"===a)}a.s(["canAssignJobs",()=>b,"canChangeMemberRoles",()=>g,"canManageMembers",()=>d,"canManageOrgSettings",()=>f,"canManageTeams",()=>c,"canRemoveMembers",()=>h,"canViewAllOrgBookings",()=>i,"canViewOrgEarnings",()=>e])},36288,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},89224,a=>{"use strict";var b=a.i(59838),c=a.i(75557),d=a.i(54380),e=a.i(14650),f=a.i(74857);async function g(a,b){let g=await (0,c.createClient)(),h=await (0,d.requireDetailer)(),{data:i,error:j}=await g.from("bookings").select("id, organization_id, detailer_id, status").eq("id",a).single();if(j||!i)throw Error("Booking not found");if(i.organization_id)if("organization"===await (0,d.getDetailerMode)()){let a=await (0,e.getDetailerOrganization)();if(a){let b=await (0,e.getOrganizationRole)(a.id);if(!(0,f.canAssignJobs)(b))throw Error("You do not have permission to assign jobs")}}else{let{data:a}=await g.rpc("get_detailer_by_profile",{p_profile_id:null});if(b!==a?.id)throw Error("Solo detailers can only be assigned to themselves")}else{let{data:a}=await g.rpc("get_detailer_by_profile",{p_profile_id:null});if(b!==a?.id)throw Error("You can only assign jobs to yourself")}let{data:k}=await g.from("detailers").select("id, organization_id").eq("id",b).single();if(!k)throw Error("Detailer not found");if(i.organization_id&&k.organization_id!==i.organization_id)throw Error("Detailer is not in the same organization");let{error:l}=await g.from("bookings").update({detailer_id:b,updated_at:new Date().toISOString()}).eq("id",a);if(l)throw Error("Failed to assign job");let{error:m}=await g.from("booking_timeline").insert({booking_id:a,status_from:i.status,status_to:i.status,changed_by:h.id,notes:"Job assigned to detailer"});return m&&console.error("Failed to create timeline entry:",m),{success:!0}}(0,a.i(36288).ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"60d858c2f9116937f1ff29a4433a628e709b07024a",null),a.s(["assignJobToDetailer",()=>g])},56946,a=>{"use strict";var b=a.i(89224);a.s([],33532),a.i(33532),a.s(["60d858c2f9116937f1ff29a4433a628e709b07024a",()=>b.assignJobToDetailer],56946)}];

//# sourceMappingURL=cleanswift_web-dashboard_aec64244._.js.map
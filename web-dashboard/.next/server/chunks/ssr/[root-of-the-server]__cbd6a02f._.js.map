{"version":3,"sources":["../../../../../../cleanswift/web-dashboard/app/detailer/teams/%5Bid%5D/TeamDetailClient.tsx/__nextjs-internal-proxy.mjs","../../../../../../cleanswift/web-dashboard/app/detailer/teams/%5Bid%5D/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/cleanswift/web-dashboard/app/detailer/teams/[id]/TeamDetailClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/cleanswift/web-dashboard/app/detailer/teams/[id]/TeamDetailClient.tsx\",\n    \"default\",\n);\n","import { requireDetailer, getDetailerMode } from '@/lib/auth';\nimport { createClient } from '@/lib/supabase/server';\nimport { getDetailerOrganization, getOrganizationRole } from '@/lib/detailer/mode-detection';\nimport { redirect } from 'next/navigation';\nimport TeamDetailClient from './TeamDetailClient';\n\nexport default async function TeamDetailPage({ params }: { params: { id: string } }) {\n  const profile = await requireDetailer();\n  const mode = await getDetailerMode();\n\n  if (mode === 'solo') {\n    redirect('/detailer/dashboard');\n  }\n\n  const supabase = await createClient();\n  const organization = await getDetailerOrganization();\n  const orgRole = organization ? await getOrganizationRole(organization.id) : null;\n\n  if (!organization) {\n    redirect('/detailer/dashboard');\n  }\n\n  // Get team details\n  const { data: team } = await supabase\n    .from('teams')\n    .select(`\n      *,\n      team_members (\n        id,\n        detailer:detailers (\n          id,\n          full_name,\n          rating,\n          review_count,\n          profile:profiles (email)\n        )\n      )\n    `)\n    .eq('id', params.id)\n    .eq('organization_id', organization.id)\n    .single();\n\n  if (!team) {\n    redirect('/detailer/teams');\n  }\n\n  // Get team's bookings\n  const { data: bookings } = await supabase\n    .from('bookings')\n    .select('id, receipt_id, status, total_amount, scheduled_date, service:service_id (name)')\n    .eq('team_id', params.id)\n    .order('scheduled_date', { ascending: false })\n    .limit(20);\n\n  // Calculate team metrics\n  const completedBookings = bookings?.filter((b) => b.status === 'completed') || [];\n  const totalRevenue = completedBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\n  const avgRating =\n    team.team_members?.reduce((sum: number, tm: any) => sum + (tm.detailer?.rating || 0), 0) /\n      (team.team_members?.length || 1) || 0;\n\n  return (\n    <div className=\"min-h-screen bg-[#050B12] text-white\">\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <TeamDetailClient\n          team={team}\n          bookings={bookings || []}\n          metrics={{\n            totalRevenue,\n            completedJobs: completedBookings.length,\n            averageRating: avgRating,\n            totalMembers: team.team_members?.length || 0,\n          }}\n          organizationId={organization.id}\n          canManageTeams={orgRole === 'owner' || orgRole === 'manager'}\n        />\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"kWAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,uUAAyU,EACtW,sGACA,6DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,mTAAqT,EAClV,kFACA,kICLJ,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,eAAe,EAAe,QAAE,CAAM,CAA8B,EACjE,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,IAGjC,AAAS,QAAQ,CAFR,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,KAGhC,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,uBAGX,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,EAAe,MAAM,CAAA,EAAA,EAAA,uBAAA,AAAuB,IAC5C,EAAU,EAAe,MAAM,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,EAAa,EAAE,EAAI,IAExE,CAAC,GACH,CAAA,EAAA,EAAA,MADiB,EACjB,AAAQ,EAAC,uBAIX,GAAM,CAAE,KAAM,CAAI,CAAE,CAAG,MAAM,EAC1B,IAAI,CAAC,SACL,MAAM,CAAC,CAAC;;;;;;;;;;;;IAYT,CAAC,EACA,EAAE,CAAC,KAAM,EAAO,EAAE,EAClB,EAAE,CAAC,kBAAmB,EAAa,EAAE,EACrC,MAAM,EAEL,CAAC,GACH,CAAA,EADS,AACT,EAAA,QAAA,AAAQ,EAAC,mBAIX,GAAM,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAC9B,IAAI,CAAC,YACL,MAAM,CAAC,mFACP,EAAE,CAAC,UAAW,EAAO,EAAE,EACvB,KAAK,CAAC,iBAAkB,CAAE,WAAW,CAAM,GAC3C,KAAK,CAAC,IAGH,EAAoB,GAAU,OAAO,AAAC,GAAM,AAAa,gBAAX,MAAM,GAAqB,EAAE,CAC3E,EAAe,EAAkB,MAAM,CAAC,CAAC,EAAK,IAAM,GAAO,EAAE,CAAH,WAAe,GAAI,CAAC,CAAG,GACjF,EACJ,EAAK,YAAY,EAAE,OAAO,CAAC,EAAa,IAAY,GAAO,EAAG,CAAJ,OAAY,EAAE,SAAU,CAAC,CAAG,IACnF,CAAD,CAAM,YAAY,EAAE,SAAU,CAAC,EAAK,EAExC,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAgB,CAAA,CACf,KAAM,EACN,SAAU,GAAY,EAAE,CACxB,QAAS,cACP,EACA,cAAe,EAAkB,MAAM,CACvC,cAAe,EACf,aAAc,EAAK,YAAY,EAAE,QAAU,CAC7C,EACA,eAAgB,EAAa,EAAE,CAC/B,eAA4B,UAAZ,GAAmC,YAAZ,OAKjD","ignoreList":[0]}
module.exports=[75577,a=>{"use strict";let b=(0,a.i(44322).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/cleanswift/web-dashboard/app/detailer/dashboard/CalendarView.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/cleanswift/web-dashboard/app/detailer/dashboard/CalendarView.tsx <module evaluation>","default");a.s(["default",0,b])},61053,a=>{"use strict";let b=(0,a.i(44322).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/cleanswift/web-dashboard/app/detailer/dashboard/CalendarView.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/cleanswift/web-dashboard/app/detailer/dashboard/CalendarView.tsx","default");a.s(["default",0,b])},36466,a=>{"use strict";a.i(75577);var b=a.i(61053);a.n(b)},86237,a=>{"use strict";let b=(0,a.i(44322).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/cleanswift/web-dashboard/components/detailer/EarningsChart.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/cleanswift/web-dashboard/components/detailer/EarningsChart.tsx <module evaluation>","default");a.s(["default",0,b])},41644,a=>{"use strict";let b=(0,a.i(44322).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/cleanswift/web-dashboard/components/detailer/EarningsChart.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/cleanswift/web-dashboard/components/detailer/EarningsChart.tsx","default");a.s(["default",0,b])},53656,a=>{"use strict";a.i(86237);var b=a.i(41644);a.n(b)},73320,a=>{"use strict";var b=a.i(2813),c=a.i(54380),d=a.i(75557),e=a.i(16728),f=a.i(36466);function g({stats:a}){return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((a,c)=>(0,b.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,b.jsx)("div",{className:"text-[#C6CFD9] text-sm mb-2",children:a.label}),(0,b.jsx)("div",{className:`text-3xl font-bold ${(a=>{switch(a){case"success":return"text-[#32CE7A]";case"warning":return"text-yellow-400";default:return"text-white"}})(a.color)}`,children:a.value}),a.subtitle&&(0,b.jsx)("div",{className:"text-xs text-[#C6CFD9] mt-1",children:a.subtitle})]},c))})}function h(a){let b="string"==typeof a?parseFloat(a):a;return isNaN(b)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(b)}function i({status:a,className:c=""}){let d=function(a){switch(a){case"accepted":return"bg-[#1DA4F3]/20 border-[#1DA4F3]/40 text-[#1DA4F3]";case"in_progress":return"bg-[#6FF0C4]/20 border-[#6FF0C4]/40 text-[#6FF0C4]";case"completed":return"bg-[#32CE7A]/20 border-[#32CE7A]/40 text-[#32CE7A]";case"cancelled":case"no_show":return"bg-red-500/20 border-red-500/40 text-red-400";case"paid":case"offered":return"bg-yellow-500/20 border-yellow-500/40 text-yellow-400";default:return"bg-[#C6CFD9]/20 border-[#C6CFD9]/40 text-[#C6CFD9]"}}(a);return(0,b.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${d} ${c}`,children:a.replace("_"," ")})}function j({bookings:a}){return 0===a.length?(0,b.jsx)("div",{className:"text-center py-8 text-[#C6CFD9]",children:"No jobs scheduled for today"}):(0,b.jsx)("div",{className:"space-y-3",children:a.slice(0,10).map(a=>{var c,d;return(0,b.jsx)(e.default,{href:`/detailer/bookings/${a.id}`,className:"block bg-[#050B12] border border-white/5 rounded-lg p-4 hover:border-[#6FF0C4]/20 transition-colors",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"font-semibold text-white mb-1",children:[a.car?.make," ",a.car?.model," ",a.car?.year]}),(0,b.jsxs)("div",{className:"text-sm text-[#C6CFD9] mb-2",children:[a.service?.name," - ",a.user?.full_name]}),(0,b.jsx)("div",{className:"text-sm text-[#C6CFD9]",children:a.scheduled_date&&a.scheduled_time_start?(c=a.scheduled_date,d=a.scheduled_time_start,function(a,b="short"){let c="string"==typeof a?new Date(a):a;return"time"===b?c.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"long"===b?c.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):c.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}(new Date(`${c}T${d}`),"long")):a.scheduled_start?new Date(a.scheduled_start).toLocaleString():"Time TBD"}),a.address_line1&&(0,b.jsxs)("div",{className:"text-xs text-[#C6CFD9] mt-1",children:[a.address_line1,", ",a.city]})]}),(0,b.jsxs)("div",{className:"text-right ml-4",children:[(0,b.jsxs)("div",{className:"text-white font-semibold mb-2",children:["$",a.service?.price||a.total_amount||0]}),(0,b.jsx)(i,{status:a.status})]})]})},a.id)})})}var k=a.i(53656),l=a.i(14650);async function m(){let a=await (0,c.requireDetailer)(),i=await (0,d.createClient)(),m=await (0,c.getDetailerMode)(),n="organization"===m?await (0,l.getDetailerOrganization)():null,o=n?await (0,l.getOrganizationRole)(n.id):null,{data:p}=await i.rpc("get_detailer_by_profile",{p_profile_id:null}),q=[],r=[],s=[],t=[],u=[],v={upcoming:0,inProgress:0,completed:0,totalEarnings:0},w={totalJobs:0,activeDetailers:0,teams:0,totalRevenue:0},x=[],y=0,z=0,A=[];if(p?.id){if("organization"===m&&n)if(o&&["owner","manager","dispatcher"].includes(o)){let{data:a}=await i.from("bookings").select(`
            id,
            receipt_id,
            status,
            payment_status,
            scheduled_date,
            scheduled_time_start,
            scheduled_time_end,
            scheduled_start,
            scheduled_end,
            total_amount,
            organization_id,
            team_id,
            detailer_id,
            service:service_id (id, name, price, duration_minutes),
            car:car_id (id, make, model, year, license_plate),
            user:user_id (id, full_name, phone, email),
            detailer:detailers (id, full_name),
            address_line1,
            city,
            province,
            postal_code
          `).eq("organization_id",n.id).in("status",["accepted","in_progress","completed","scheduled"]).order("scheduled_date",{ascending:!0}).order("scheduled_time_start",{ascending:!0});r=a||[];let{data:b}=await i.from("bookings").select("*").eq("detailer_id",p.id).in("status",["accepted","in_progress","completed"]);q=b||[],w.totalJobs=r.length,w.totalRevenue=r.filter(a=>"completed"===a.status).reduce((a,b)=>a+(b.total_amount||0),0);let{data:c}=await i.from("organization_members").select("id").eq("organization_id",n.id).eq("is_active",!0).eq("role","detailer");w.activeDetailers=c?.length||0;let{data:d}=await i.from("teams").select("id").eq("organization_id",n.id).eq("is_active",!0);w.teams=d?.length||0;let e=new Date;A=r.filter(a=>!!("scheduled"===a.status&&!a.detailer_id||a.scheduled_start&&new Date(a.scheduled_start)<e&&["scheduled","accepted"].includes(a.status))||!1).map(a=>({type:a.detailer_id?"late":"unassigned",message:a.detailer_id?`Job ${a.receipt_id} is running late`:`Job ${a.receipt_id} needs assignment`,bookingId:a.id})).slice(0,5)}else{let{data:a}=await i.from("bookings").select(`
            id,
            receipt_id,
            status,
            payment_status,
            scheduled_date,
            scheduled_time_start,
            scheduled_time_end,
            scheduled_start,
            scheduled_end,
            total_amount,
            service:service_id (id, name, price, duration_minutes),
            car:car_id (id, make, model, year, license_plate),
            user:user_id (id, full_name, phone, email),
            address_line1,
            city,
            province,
            postal_code
          `).eq("detailer_id",p.id).in("status",["accepted","in_progress","completed"]).order("scheduled_date",{ascending:!0}).order("scheduled_time_start",{ascending:!0});q=a||[]}else{let{data:a}=await i.from("bookings").select(`
          id,
          receipt_id,
          status,
          payment_status,
          scheduled_date,
          scheduled_time_start,
          scheduled_time_end,
          scheduled_start,
          scheduled_end,
          total_amount,
          service:service_id (id, name, price, duration_minutes),
          car:car_id (id, make, model, year, license_plate),
          user:user_id (id, full_name, phone, email),
          address_line1,
          city,
          province,
          postal_code
        `).eq("detailer_id",p.id).in("status",["accepted","in_progress","completed"]).order("scheduled_date",{ascending:!0}).order("scheduled_time_start",{ascending:!0});q=a||[]}let{data:a}=await i.from("detailer_availability").select("*").eq("detailer_id",p.id).eq("is_active",!0);s=a||[],t=q.filter(a=>{if(!a.scheduled_date||!a.scheduled_time_start)return!1;let b=new Date(a.scheduled_date).getDay(),c=s.find(a=>a.day_of_week===b);if(!c)return!1;let d=a.scheduled_time_start,e=a.scheduled_time_end||a.scheduled_time_start,f=c.start_time,g=c.end_time,h=d.substring(0,5),i=e.substring(0,5),j=f.substring(0,5),k=g.substring(0,5);return h>=j&&i<=k});let b="organization"===m&&r.length>0?r:t;v.upcoming=b.filter(a=>"accepted"===a.status||"scheduled"===a.status).length,v.inProgress=b.filter(a=>"in_progress"===a.status).length,v.completed=b.filter(a=>"completed"===a.status).length,v.totalEarnings=b.filter(a=>"completed"===a.status).reduce((a,b)=>a+(b.total_amount||b.service?.price||0),0),u=function(a,b){if("all"===b)return a;let c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate());return a.filter(a=>{let c=a.scheduled_date?new Date(a.scheduled_date):a.scheduled_start?new Date(a.scheduled_start):null;if(!c)return!1;let e=new Date(c.getFullYear(),c.getMonth(),c.getDate());switch(b){case"today":return e.getTime()===d.getTime();case"tomorrow":let f=new Date(d);return f.setDate(f.getDate()+1),e.getTime()===f.getTime();case"this_week":let g=new Date(d);g.setDate(d.getDate()-d.getDay());let h=new Date(g);return h.setDate(g.getDate()+6),c>=g&&c<=h;case"this_month":return c.getMonth()===d.getMonth()&&c.getFullYear()===d.getFullYear();default:return!0}})}("organization"===m&&r.length>0?r:t,"today");let c=("organization"===m&&r.length>0?r:t).filter(a=>"completed"===a.status),d={};c.forEach(a=>{let b=a.completed_at||a.scheduled_date||a.created_at;if(b){let c=new Date(b).toISOString().split("T")[0],e=a.service?.price||a.total_amount||0;d[c]=(d[c]||0)+e}});let e=new Date;for(let a=6;a>=0;a--){let b=new Date(e);b.setDate(b.getDate()-a);let c=b.toISOString().split("T")[0];x.push({date:c,amount:d[c]||0})}y=p.rating||0,z=p.review_count||0}let B="organization"===m&&o&&["owner","manager"].includes(o)?[{label:"Total Jobs",value:w.totalJobs,color:"default"},{label:"Active Detailers",value:w.activeDetailers,color:"default"},{label:"Teams",value:w.teams,color:"default"},{label:"Total Revenue",value:h(w.totalRevenue),color:"success"}]:[{label:"Upcoming",value:v.upcoming,color:"default"},{label:"In Progress",value:v.inProgress,color:"default"},{label:"Completed",value:v.completed,color:"default"},{label:"Total Earnings",value:h(v.totalEarnings),color:"success"}];return(0,b.jsx)("div",{className:"min-h-screen bg-[#050B12] text-white",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Dashboard"}),(0,b.jsxs)("p",{className:"text-[#C6CFD9]",children:["Welcome back, ",a.full_name]})]}),(0,b.jsx)(g,{stats:B}),"organization"===m&&A.length>0&&(0,b.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-6 mb-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-yellow-400 mb-4",children:"⚠️ Issues That Need Attention"}),(0,b.jsx)("div",{className:"space-y-2",children:A.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-[#050B12] rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-yellow-400 font-medium",children:"unassigned"===a.type?"Unassigned":"Late"}),(0,b.jsx)("span",{className:"text-[#C6CFD9] ml-2",children:a.message})]}),a.bookingId&&(0,b.jsx)(e.default,{href:`/detailer/bookings/${a.bookingId}`,className:"text-[#32CE7A] hover:text-[#6FF0C4] text-sm font-medium",children:"View →"})]},c))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8 mt-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Earnings (Last 7 Days)"}),(0,b.jsx)(k.default,{data:x,period:"day"})]}),(0,b.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Rating"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-4xl font-bold text-[#32CE7A]",children:y.toFixed(1)}),(0,b.jsx)("div",{className:"flex gap-1",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("span",{className:`text-2xl ${c<Math.round(y)?"text-yellow-400":"text-[#C6CFD9]"}`,children:"★"},c))})]}),(0,b.jsxs)("p",{className:"text-sm text-[#C6CFD9] mb-4",children:[z," reviews"]}),(0,b.jsx)(e.default,{href:"/detailer/reviews",className:"text-[#32CE7A] hover:text-[#6FF0C4] text-sm font-medium",children:"View all reviews →"})]})]}),(0,b.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6 mb-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Today's Jobs"}),(0,b.jsx)(j,{bookings:u})]}),(0,b.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6 mb-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"organization"===m?"Organization Calendar":"Calendar"}),(0,b.jsx)(f.default,{bookings:"organization"===m&&r.length>0?r:t})]}),(0,b.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"organization"===m?"All Bookings":"Upcoming Bookings"}),0===("organization"===m&&r.length>0?r:t).length?(0,b.jsx)("p",{className:"text-[#C6CFD9]",children:"organization"===m?"No bookings found":"No upcoming bookings in your availability window"}):(0,b.jsx)("div",{className:"space-y-4",children:("organization"===m&&r.length>0?r:t).slice(0,10).map(a=>(0,b.jsx)(e.default,{href:`/detailer/bookings/${a.id}`,className:"block bg-[#050B12] border border-white/5 rounded-lg p-4 hover:border-[#6FF0C4]/20 transition-colors",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-semibold text-white",children:[a.car?.make," ",a.car?.model," ",a.car?.year]}),(0,b.jsxs)("div",{className:"text-sm text-[#C6CFD9] mt-1",children:[a.service?.name," - ",a.user?.full_name,"organization"===m&&a.detailer&&(0,b.jsxs)("span",{className:"ml-2 text-[#32CE7A]",children:["• ",a.detailer.full_name]})]}),(0,b.jsx)("div",{className:"text-sm text-[#C6CFD9] mt-1",children:a.scheduled_date&&a.scheduled_time_start?`${new Date(a.scheduled_date).toLocaleDateString()} at ${a.scheduled_time_start.substring(0,5)}`:a.scheduled_start?new Date(a.scheduled_start).toLocaleString():"Date TBD"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"text-white font-semibold",children:["$",a.service?.price||a.total_amount||0]}),(0,b.jsx)("div",{className:"text-xs text-[#C6CFD9] mt-1 capitalize",children:a.status})]})]})},a.id))})]})]})})}a.s(["default",()=>m],73320)}];

//# sourceMappingURL=cleanswift_web-dashboard_9e1dd936._.js.map
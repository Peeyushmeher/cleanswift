module.exports=[61535,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(9753),g=a.r(47739),h=a.r(79085)},40839,a=>{"use strict";function b(a){let b="string"==typeof a?parseFloat(a):a;return isNaN(b)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(b)}function c(a,b="short"){let d="string"==typeof a?new Date(a):a;return"time"===b?d.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"long"===b?d.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):d.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function d(a){switch(a){case"accepted":return"bg-[#1DA4F3]/20 border-[#1DA4F3]/40 text-[#1DA4F3]";case"in_progress":return"bg-[#6FF0C4]/20 border-[#6FF0C4]/40 text-[#6FF0C4]";case"completed":return"bg-[#32CE7A]/20 border-[#32CE7A]/40 text-[#32CE7A]";case"cancelled":case"no_show":return"bg-red-500/20 border-red-500/40 text-red-400";case"paid":case"offered":return"bg-yellow-500/20 border-yellow-500/40 text-yellow-400";default:return"bg-[#C6CFD9]/20 border-[#C6CFD9]/40 text-[#C6CFD9]"}}function e(a){switch(a){case"paid":return"text-[#32CE7A]";case"processing":return"text-yellow-400";case"failed":case"refunded":return"text-red-400";default:return"text-[#C6CFD9]"}}function f(a,b){if("all"===b)return a;let c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate());return a.filter(a=>{let c=a.scheduled_date?new Date(a.scheduled_date):a.scheduled_start?new Date(a.scheduled_start):null;if(!c)return!1;let e=new Date(c.getFullYear(),c.getMonth(),c.getDate());switch(b){case"today":return e.getTime()===d.getTime();case"tomorrow":let f=new Date(d);return f.setDate(f.getDate()+1),e.getTime()===f.getTime();case"this_week":let g=new Date(d);g.setDate(d.getDate()-d.getDay());let h=new Date(g);return h.setDate(g.getDate()+6),c>=g&&c<=h;case"this_month":return c.getMonth()===d.getMonth()&&c.getFullYear()===d.getFullYear();default:return!0}})}function g(a,b){let c=[...a];switch(b){case"time":return c.sort((a,b)=>{let c=a.scheduled_date||a.scheduled_start||"",d=b.scheduled_date||b.scheduled_start||"";return new Date(c).getTime()-new Date(d).getTime()});case"price":return c.sort((a,b)=>{let c=a.total_amount||a.service_price||0;return(b.total_amount||b.service_price||0)-c});case"distance":case"rating":default:return c;case"assignment":return c.sort((a,b)=>{let c=new Date(a.created_at||0).getTime();return new Date(b.created_at||0).getTime()-c})}}a.s(["filterBookingsByDateRange",()=>f,"formatCurrency",()=>b,"formatDate",()=>c,"getPaymentStatusColor",()=>e,"getStatusColor",()=>d,"sortBookings",()=>g])},29957,71143,95942,a=>{"use strict";var b=a.i(36679),c=a.i(40839);function d({status:a,className:d=""}){let e=(0,c.getStatusColor)(a);return(0,b.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${e} ${d}`,children:a.replace("_"," ")})}a.s(["default",()=>d],29957);var e=a.i(2852),f=a.i(35816);function g({size:a="md",className:c=""}){return(0,b.jsx)("div",{className:`flex items-center justify-center ${c}`,children:(0,b.jsx)("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[a]} border-4 border-[#0A1A2F] border-t-[#32CE7A] rounded-full animate-spin`,role:"status","aria-label":"Loading",children:(0,b.jsx)("span",{className:"sr-only",children:"Loading..."})})})}a.s(["default",()=>g],71143);var h=a.i(61535),i=(0,h.createServerReference)("60d858c2f9116937f1ff29a4433a628e709b07024a",h.callServer,void 0,h.findSourceMapURL,"assignJobToDetailer");function j({isOpen:a,onClose:c,bookingId:d,organizationId:h,currentDetailerId:j,onAssigned:k}){let[l,m]=(0,e.useState)([]),[n,o]=(0,e.useState)(!1),[p,q]=(0,e.useState)(!1),[r,s]=(0,e.useState)(""),[t,u]=(0,e.useState)(""),[v,w]=(0,e.useState)("all"),[x,y]=(0,e.useState)([]),z=(0,f.createClient)();(0,e.useEffect)(()=>{a&&(B(),A())},[a,h]);let A=async()=>{let{data:a}=await z.from("teams").select("id, name").eq("organization_id",h).eq("is_active",!0);y(a||[])},B=async()=>{o(!0);try{let{data:a}=await z.rpc("get_organization_members",{p_organization_id:h}),b=(a||[]).filter(a=>"detailer"===a.role&&a.is_active).map(a=>a.profile_id);if(0===b.length){m([]),o(!1);return}let{data:c}=await z.from("detailers").select("id, full_name, rating, review_count").in("profile_id",b),{data:d}=await z.from("bookings").select("detailer_id").eq("organization_id",h).in("status",["accepted","in_progress","scheduled"]),e={};d?.forEach(a=>{a.detailer_id&&(e[a.detailer_id]=(e[a.detailer_id]||0)+1)});let f=(c||[]).map(a=>({id:a.id,full_name:a.full_name,rating:a.rating||0,review_count:a.review_count||0,current_job_count:e[a.id]||0,is_available:!0}));m(f)}catch(a){console.error("Error loading detailers:",a)}finally{o(!1)}},C=async()=>{if(r){q(!0);try{await i(d,r),k(),c()}catch(a){console.error("Error assigning job:",a),alert("Failed to assign job. Please try again.")}finally{q(!1)}}},D=l.filter(a=>a.full_name.toLowerCase().includes(t.toLowerCase()));return a?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:c}),(0,b.jsxs)("div",{className:"relative z-10 w-full max-w-2xl mx-4 bg-[#0A1A2F] border border-white/5 rounded-xl shadow-xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,b.jsx)("div",{className:"p-6 border-b border-white/5",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Assign Job to Detailer"}),(0,b.jsx)("button",{onClick:c,className:"text-[#C6CFD9] hover:text-white transition-colors",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,b.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"Search detailers...",value:t,onChange:a=>u(a.target.value),className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40"}),x.length>0&&(0,b.jsxs)("select",{value:v,onChange:a=>w(a.target.value),className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white focus:outline-none focus:border-[#32CE7A]/40",children:[(0,b.jsx)("option",{value:"all",children:"All Teams"}),x.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),n?(0,b.jsx)("div",{className:"flex justify-center py-12",children:(0,b.jsx)(g,{size:"lg"})}):0===D.length?(0,b.jsx)("div",{className:"text-center py-12 text-[#C6CFD9]",children:"No detailers found"}):(0,b.jsx)("div",{className:"space-y-2",children:D.map(a=>(0,b.jsx)("button",{onClick:()=>s(a.id),className:`
                    w-full p-4 rounded-lg border transition-colors text-left
                    ${r===a.id?"bg-[#32CE7A]/20 border-[#32CE7A]/40":"bg-[#050B12] border-white/5 hover:border-white/10"}
                    ${a.id===j?"opacity-50 cursor-not-allowed":""}
                  `,disabled:a.id===j,children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-white",children:a.full_name}),a.id===j&&(0,b.jsx)("span",{className:"text-xs bg-[#32CE7A]/20 text-[#32CE7A] px-2 py-1 rounded",children:"Current"})]}),(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-4 text-sm text-[#C6CFD9]",children:[(0,b.jsxs)("span",{children:["â­ ",a.rating.toFixed(1)," (",a.review_count," reviews)"]}),(0,b.jsxs)("span",{children:["ðŸ“‹ ",a.current_job_count," active jobs"]}),a.distance&&(0,b.jsxs)("span",{children:["ðŸ“ ",a.distance.toFixed(1)," km"]})]})]}),r===a.id&&(0,b.jsx)("div",{className:"ml-4",children:(0,b.jsx)("div",{className:"w-5 h-5 rounded-full bg-[#32CE7A] flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]})},a.id))})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3",children:[(0,b.jsx)("button",{onClick:c,className:"px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white hover:border-white/10 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{onClick:C,disabled:!r||p,className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Assigning...":"Assign Job"})]})]})]}):null}a.s(["default",()=>j],95942)}];

//# sourceMappingURL=cleanswift_web-dashboard_b4ee34d6._.js.map
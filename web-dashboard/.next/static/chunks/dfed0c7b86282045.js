(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7801,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={callServer:function(){return a.callServer},createServerReference:function(){return d.createServerReference},findSourceMapURL:function(){return l.findSourceMapURL}};for(var i in s)Object.defineProperty(r,i,{enumerable:!0,get:s[i]});let a=e.r(31738),l=e.r(88410),d=e.r(61631)},53214,24112,e=>{"use strict";var t=e.i(84394),r=e.i(67589),s=e.i(76708),i=e.i(7801),a=(0,i.createServerReference)("7c9e886cc9b6842afc1ea140e9177bb5ff09d4a3a4",i.callServer,void 0,i.findSourceMapURL,"createTeam"),l=(0,i.createServerReference)("7ce42137efe2c23d4b85f8f016fe67dbee01b8d728",i.callServer,void 0,i.findSourceMapURL,"updateTeam");function d({isOpen:e,onClose:i,organizationId:d,team:n,onSaved:c}){let[o,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[b,u]=(0,r.useState)({}),[f,v]=(0,r.useState)(!1),[p,j]=(0,r.useState)(null),[g,N]=(0,r.useState)([]),[w,C]=(0,r.useState)([]),y=(0,s.createClient)();(0,r.useEffect)(()=>{e&&(n?(m(n.name),h(n.description||""),u(n.service_area||{}),F()):(m(""),h(""),u({}),C([])),A())},[e,n]);let A=async()=>{let{data:e}=await y.rpc("get_organization_members",{p_organization_id:d}),t=(e||[]).filter(e=>"detailer"===e.role&&e.is_active).map(e=>e.profile_id);if(0===t.length)return void N([]);let{data:r}=await y.from("detailers").select("id, full_name").in("profile_id",t);N(r||[])},F=async()=>{if(!n)return;let{data:e}=await y.from("team_members").select("detailer_id").eq("team_id",n.id);C((e||[]).map(e=>e.detailer_id))},S=async e=>{e.preventDefault(),j(null),v(!0);try{n?await l(n.id,o,x||null,b,w):await a(d,o,x||null,b,w),c(),i()}catch(e){j(e.message||"Failed to save team")}finally{v(!1)}};return e?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:i}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-2xl mx-4 bg-[#0A1A2F] border border-white/5 rounded-xl shadow-xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsx)("div",{className:"p-6 border-b border-white/5",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:n?"Edit Team":"Create Team"}),(0,t.jsx)("button",{onClick:i,className:"text-[#C6CFD9] hover:text-white transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsxs)("form",{onSubmit:S,className:"flex-1 overflow-y-auto p-6",children:[p&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/40 rounded-lg text-red-400 text-sm",children:p}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-white mb-2",children:"Team Name *"}),(0,t.jsx)("input",{type:"text",id:"name",value:o,onChange:e=>m(e.target.value),required:!0,className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-white mb-2",children:"Description"}),(0,t.jsx)("textarea",{id:"description",value:x,onChange:e=>h(e.target.value),rows:3,className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Team Members"}),(0,t.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:g.map(e=>(0,t.jsxs)("label",{className:"flex items-center p-3 bg-[#050B12] border border-white/5 rounded-lg hover:border-[#32CE7A]/40 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:w.includes(e.id),onChange:t=>{t.target.checked?C([...w,e.id]):C(w.filter(t=>t!==e.id))},className:"mr-3 w-4 h-4 text-[#32CE7A] bg-[#050B12] border-white/5 rounded focus:ring-[#32CE7A]"}),(0,t.jsx)("span",{className:"text-white",children:e.full_name})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:i,className:"px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white hover:border-white/10 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:f||!o,className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Saving...":n?"Update Team":"Create Team"})]})]})]})]}):null}e.s(["default",()=>d],53214);var n=(0,i.createServerReference)("40c3272981a6808b5628b331a605ca0fd5ddb2b73e",i.callServer,void 0,i.findSourceMapURL,"deleteTeam");e.s(["deleteTeam",()=>n],24112)},57983,e=>{"use strict";var t=e.i(84394),r=e.i(67589),s=e.i(50067),i=e.i(13028),a=e.i(53214),l=e.i(24112);function d({team:e,bookings:d,metrics:n,organizationId:c,canManageTeams:o}){let[m,x]=(0,r.useState)(!1),h=(0,s.useRouter)(),b=async()=>{if(confirm("Are you sure you want to delete this team?"))try{await (0,l.deleteTeam)(e.id),h.push("/detailer/teams")}catch(e){alert(e.message||"Failed to delete team")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.default,{href:"/detailer/teams",className:"text-[#6FF0C4] hover:text-[#32CE7A] mb-4 inline-block",children:"← Back to Teams"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-white",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-[#C6CFD9] mt-1",children:e.description})]}),o&&(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors",children:"Edit Team"}),(0,t.jsx)("button",{onClick:b,className:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 font-semibold rounded-lg transition-colors",children:"Delete"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-sm text-[#C6CFD9] mb-1",children:"Total Revenue"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-[#32CE7A]",children:["$",n.totalRevenue.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-sm text-[#C6CFD9] mb-1",children:"Completed Jobs"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:n.completedJobs})]}),(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-sm text-[#C6CFD9] mb-1",children:"Average Rating"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-white",children:["⭐ ",n.averageRating.toFixed(1)]})]}),(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-4",children:[(0,t.jsx)("div",{className:"text-sm text-[#C6CFD9] mb-1",children:"Members"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:n.totalMembers})]})]}),(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Team Members"}),e.team_members&&e.team_members.length>0?(0,t.jsx)("div",{className:"space-y-2",children:e.team_members.map(e=>(0,t.jsx)(i.default,{href:`/detailer/members/${e.detailer.profile?.id||""}`,className:"block p-3 bg-[#050B12] border border-white/5 rounded-lg hover:border-[#32CE7A]/40 transition-colors",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-white",children:e.detailer.full_name}),(0,t.jsxs)("div",{className:"text-sm text-[#C6CFD9]",children:["⭐ ",e.detailer.rating?.toFixed(1)||"0.0"," (",e.detailer.review_count||0," reviews)"]})]}),(0,t.jsx)("div",{className:"text-[#32CE7A]",children:"View →"})]})},e.id))}):(0,t.jsx)("p",{className:"text-[#C6CFD9]",children:"No members in this team"})]}),d.length>0&&(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Recent Bookings"}),(0,t.jsx)("div",{className:"space-y-2",children:d.map(e=>(0,t.jsx)(i.default,{href:`/detailer/bookings/${e.id}`,className:"block p-3 bg-[#050B12] border border-white/5 rounded-lg hover:border-[#32CE7A]/40 transition-colors",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-white",children:e.receipt_id}),(0,t.jsx)("div",{className:"text-sm text-[#C6CFD9]",children:e.service?.name})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-white font-semibold",children:["$",e.total_amount||0]}),(0,t.jsx)("div",{className:"text-xs text-[#C6CFD9] capitalize",children:e.status})]})]})},e.id))})]})]}),(0,t.jsx)(a.default,{isOpen:m,onClose:()=>x(!1),organizationId:c,team:e,onSaved:()=>{h.refresh()}})]})}e.s(["default",()=>d])}]);
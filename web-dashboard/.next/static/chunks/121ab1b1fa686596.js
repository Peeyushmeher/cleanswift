(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7801,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={callServer:function(){return i.callServer},createServerReference:function(){return d.createServerReference},findSourceMapURL:function(){return l.findSourceMapURL}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let i=e.r(31738),l=e.r(88410),d=e.r(61631)},53214,24112,e=>{"use strict";var t=e.i(84394),r=e.i(67589),s=e.i(76708),a=e.i(7801),i=(0,a.createServerReference)("7c9e886cc9b6842afc1ea140e9177bb5ff09d4a3a4",a.callServer,void 0,a.findSourceMapURL,"createTeam"),l=(0,a.createServerReference)("7ce42137efe2c23d4b85f8f016fe67dbee01b8d728",a.callServer,void 0,a.findSourceMapURL,"updateTeam");function d({isOpen:e,onClose:a,organizationId:d,team:n,onSaved:o}){let[c,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(""),[h,b]=(0,r.useState)({}),[f,p]=(0,r.useState)(!1),[v,g]=(0,r.useState)(null),[j,w]=(0,r.useState)([]),[C,N]=(0,r.useState)([]),y=(0,s.createClient)();(0,r.useEffect)(()=>{e&&(n?(m(n.name),u(n.description||""),b(n.service_area||{}),A()):(m(""),u(""),b({}),N([])),S())},[e,n]);let S=async()=>{let{data:e}=await y.rpc("get_organization_members",{p_organization_id:d}),t=(e||[]).filter(e=>"detailer"===e.role&&e.is_active).map(e=>e.profile_id);if(0===t.length)return void w([]);let{data:r}=await y.from("detailers").select("id, full_name").in("profile_id",t);w(r||[])},A=async()=>{if(!n)return;let{data:e}=await y.from("team_members").select("detailer_id").eq("team_id",n.id);N((e||[]).map(e=>e.detailer_id))},T=async e=>{e.preventDefault(),g(null),p(!0);try{n?await l(n.id,c,x||null,h,C):await i(d,c,x||null,h,C),o(),a()}catch(e){g(e.message||"Failed to save team")}finally{p(!1)}};return e?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:a}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-2xl mx-4 bg-[#0A1A2F] border border-white/5 rounded-xl shadow-xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsx)("div",{className:"p-6 border-b border-white/5",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:n?"Edit Team":"Create Team"}),(0,t.jsx)("button",{onClick:a,className:"text-[#C6CFD9] hover:text-white transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsxs)("form",{onSubmit:T,className:"flex-1 overflow-y-auto p-6",children:[v&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/40 rounded-lg text-red-400 text-sm",children:v}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-white mb-2",children:"Team Name *"}),(0,t.jsx)("input",{type:"text",id:"name",value:c,onChange:e=>m(e.target.value),required:!0,className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-white mb-2",children:"Description"}),(0,t.jsx)("textarea",{id:"description",value:x,onChange:e=>u(e.target.value),rows:3,className:"w-full px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white placeholder-[#C6CFD9] focus:outline-none focus:border-[#32CE7A]/40"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Team Members"}),(0,t.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:j.map(e=>(0,t.jsxs)("label",{className:"flex items-center p-3 bg-[#050B12] border border-white/5 rounded-lg hover:border-[#32CE7A]/40 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:C.includes(e.id),onChange:t=>{t.target.checked?N([...C,e.id]):N(C.filter(t=>t!==e.id))},className:"mr-3 w-4 h-4 text-[#32CE7A] bg-[#050B12] border-white/5 rounded focus:ring-[#32CE7A]"}),(0,t.jsx)("span",{className:"text-white",children:e.full_name})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-[#050B12] border border-white/5 rounded-lg text-white hover:border-white/10 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:f||!c,className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Saving...":n?"Update Team":"Create Team"})]})]})]})]}):null}e.s(["default",()=>d],53214);var n=(0,a.createServerReference)("40c3272981a6808b5628b331a605ca0fd5ddb2b73e",a.callServer,void 0,a.findSourceMapURL,"deleteTeam");e.s(["deleteTeam",()=>n],24112)},81939,e=>{"use strict";var t=e.i(84394),r=e.i(67589),s=e.i(76708),a=e.i(50067),i=e.i(13028),l=e.i(53214),d=e.i(24112);function n({initialTeams:e,organizationId:n,canManageTeams:o}){let[c,m]=(0,r.useState)(e),[x,u]=(0,r.useState)(!1),[h,b]=(0,r.useState)(!1),[f,p]=(0,r.useState)(null);(0,s.createClient)();let v=(0,a.useRouter)(),g=()=>{p(null),b(!0)},j=async e=>{if(confirm("Are you sure you want to delete this team?"))try{await (0,d.deleteTeam)(e),v.refresh()}catch(e){alert(e.message||"Failed to delete team")}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"All Teams"}),o&&(0,t.jsx)("button",{className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors",onClick:g,children:"+ Create Team"})]}),0===c.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-[#C6CFD9] mb-4",children:"No teams created yet"}),o&&(0,t.jsx)("button",{className:"px-4 py-2 bg-[#32CE7A] hover:bg-[#2AB869] text-white font-semibold rounded-lg transition-colors",onClick:g,children:"Create Your First Team"})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(e=>(0,t.jsxs)("div",{className:"bg-[#050B12] border border-white/5 rounded-lg p-6 hover:border-[#32CE7A]/40 transition-colors",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)(i.default,{href:`/detailer/teams/${e.id}`,className:"flex-1",children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:e.name})}),o&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{p(e),b(!0)},className:"text-[#32CE7A] hover:text-[#6FF0C4] text-sm",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>j(e.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-[#C6CFD9] mb-4",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-[#C6CFD9]",children:[e.team_members?.length||0," member",e.team_members?.length!==1?"s":""]}),(0,t.jsx)(i.default,{href:`/detailer/teams/${e.id}`,className:"text-[#32CE7A] hover:text-[#6FF0C4]",children:"View Details â†’"})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-[#0A1A2F] border border-white/5 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"About Teams"}),(0,t.jsx)("p",{className:"text-[#C6CFD9] text-sm",children:"Teams allow you to organize detailers into groups. Each team can have its own service area and be assigned to specific jobs. This helps with routing and scheduling."})]}),(0,t.jsx)(l.default,{isOpen:h,onClose:()=>{b(!1),p(null)},organizationId:n,team:f,onSaved:()=>{v.refresh()}})]})}e.s(["default",()=>n])}]);